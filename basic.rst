NVDA の基本
-------------

スクリーンリーダー NVDA の概要
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

NVDA とはどんなソフトなのかご紹介します。 NVDA (Non Visual Desktop
Access) は、無料の Windows 用スクリーンリーダーです。 対応する Windows
のバージョンは 7, 8, 8.1, 10, そして最新の Windows 11 です。
32ビットにも64ビットにも対応しています。また、Windows 8 以降を
タッチ操作に対応した機種で使うときには、タッチで NVDA を操作できます。

NVDA は「フリーソフトウェア」です。英語の FREE
には「無料」のほかに、「自由」という意味もありますが、 NVDA
はこの両方の意味で「フリー」なソフトウェアです。つまり、NVDA
は誰でもどんな目的にでも自由に使ってよく、 また NVDA
のコピーを作って配布することも自由です。

NVDA
の改良版を作って配布することもできますが、この場合は「どのような改良をしたか」という情報（ソースコード）を
隠してはいけない、という決まりです。 だから NVDA
を誰かが改良したら、必ず他の誰かがその改良を引き継ぐことができるのです。
本当は NVDA は無料でなくても、お金をもらって販売してもよいのです。
決まっているのは「開発者が情報の公開を義務付けられている」ということだけです。
この決まりのために「お金を払った人だけが使える」という仕組みが成り立たないだけなのです。

NVDAの最初のバージョンは2006年4月に公開されました。
中心的な開発者はオーストラリアの全盲のプログラマー Michael
Curranさんです。 同じく全盲のプログラマーであるJames
Tehさんも2017年までコア開発者のひとりでした。

彼らは大学でコンピューター科学を学んだ専門家です。その技能を生かして
「視覚障害者が晴眼者と同じコストでコンピューターを利用できる」という理想のために活動を始めたのです。

NVDA
はインターネットで公開されたため、オーストラリア国内だけではなく世界の視覚障害者の関心を集めました。
開発の早い段階から、いろいろな言語に簡単に対応できる国際化の仕組みが取り入れられました。

Web ブラウザの Firefox などを開発している非営利法人 Mozilla 財団が NVDA
の支援を決めたことから、 NVDA の開発は事業として軌道に乗り始めました。

NVDA 開発者の2人を中心に非営利団体 NV Access
が設立され、コンピューター関連の企業や標準化団体、
視覚障害に関する各国の当事者団体の資金援助、個人からの寄付などによって運営されています。

非営利団体の活動として開発されていることは、NVDA
がどんなソフトウェアなのか理解するうえで重要なことです。

ソフトウェアを販売するビジネスの立場では、例えば「どんな機能をつけたらユーザーは
バージョンアップにお金を払ってくれるだろうか」などと考えなくてはなりません。

一方で非営利活動である NVDA の開発では
「視覚障害者の社会参加を促す」あるいは「アクセシビリティに配慮したソフトウェアを増やす」といった目的を
優先することができます。

結果として NVDA
は「他のソフトウェアのバグやお行儀のわるい実装を繕う」のではなく、
「他のソフトウェアの開発者がバグを直したりアクセシビリティの標準規格を守ってくれるように仕向ける」
ことを目指しています。

例えば NVDA は Windows のシステム設定（レジストリ）を書き換えたり
特別なモジュール（デバイスドライバ）をインストールしなくても動くので
「ポータブル版」という使い方ができます。
スクリーンリーダーがそのようなシステムの書き換えやインストールをするのは
「正しい役割分担ではない」と考えているようです。

スクリーンリーダーに対応した特別なアプリケーションの開発ではなく、
晴眼者が使っているアプリケーションをスクリーンリーダーでちゃんと使えるようにする、ということも、
NVDA が担う大事な使命と言えるでしょう。

NVDA 日本語版の開発
~~~~~~~~~~~~~~~~~~~~~~~

NVDA はひとつのソフトウェアで40以上の言語に対応します。
国際化という観点からも NVDA は「ユニバーサルなスクリーンリーダー」です。

しかし日本語化についてはどうしても今までの国際化の仕組みでは不十分であったため、
日本のボランティアたちが NVDA 日本語版の開発に取り組んできました。

2010年秋になんとか日本語の入力や読み上げができるものが完成したものの、
本当に実用的な日本語対応は2013年5月の 2013.1jp
からだと言ってよいでしょう。
これは前年に香港や台湾のNVDA関係者が資金援助をして行った
東アジア言語対応を NVDA 日本語チームがさらに改良して実現したものです。

点字ディスプレイへの対応に必要な日本語点訳の処理も、
日本語チームが独自に開発したもので、2013.1jp で大きく改善できました。
まだまだ改善すべきところはたくさんありますが NVDA
日本語版の実力はやっと世界に追いついたと言えるでしょう。

NVDA は3か月に1回新しいバージョンが公開されています。 NVDA
日本語版は、NVDA 本家版の新しいバージョンが公開されるたびに
新しいバージョンを公開しています。

NVDA 日本語版の入手と実行
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

NVDA 日本語版の入手
^^^^^^^^^^^^^^^^^^^^^^^^^

NVDA 日本語版は以下のアドレスから直接ダウンロード可能です。

-  https://i.nvda.jp

詳しい情報は NVDA 日本語チームのサイトからご覧ください。

-  https://www.nvda.jp

NVDAとその他のスクリーンリーダー
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ダウンロードしたファイル（ダウンロードパッケージ）を実行すると NVDA
が動作して、 NVDA が表示した画面そのものを読み上げます。

すでに他のスクリーンリーダーが動作している場合には、
複数のスクリーンリーダーが同時に動いてしまう状態になるかも知れません。

例えば Windows 「コンピューターの簡単操作センター」に備わっている
「ナレーター」という機能もスクリーンリーダーの一種です。

NVDA
に限らず、複数のスクリーンリーダーを同時に動作させることはお勧めできません。
どちらのスクリーンリーダーも正常に操作できなくなることがあります。ご注意ください。

NVDA の終了方法
^^^^^^^^^^^^^^^^^^^^^

ダウンロードパッケージが開くウィンドウを閉じても NVDA は終了しません。
NVDA 日本語版を止める方法を紹介しておきます。

-  キーボードで Insert キーを押しながらアルファベットの Q を押す

-  無変換キーを押しながらアルファベットの Q を押す

このいずれかの操作で終了ダイアログが表示されます。 終了ダイアログから
Enter キーで NVDA を終了できます。 マウスで Windows
の通知領域（タスクトレイ）を操作できる場合は、 NVDA
のアイコンをクリックして NVDA メニューから「終了」を選ぶことができます。

NVDAのインストール
^^^^^^^^^^^^^^^^^^^^^^^^

ダウンロードパッケージの機能を紹介します。

最初は「使用許諾契約」にフォーカスがあります。
ここには英語の文章が書かれていますが、
その大まかな意味はこのガイドブックで最初に紹介した内容です。
使用許諾契約から Tab
キーで「同意する」というチェックボックスに移動して、
スペースを押してチェックボックスをチェックしてください。 Tab
キーで以下の3個のボタンに移動できるようになります。

-  このコンピューターにインストール
-  ポータブル版を作成
-  動作を継続（そのまま NVDA を使う）

コンピューターに NVDA をインストールすることを選ぶと、
次の画面に「ログオン画面で NVDA
を使用」というチェックボックスがあります。
すでに他のスクリーンリーダーでログオン画面の読み上げを行っているときには、
このチェックボックスをチェックなしにしておくとよいでしょう。

インストールを完了させるには管理者権限が必要です。
「ユーザーアカウント制御」というウィンドウに
「次のプログラムにこのコンピューターへの変更を許可しますか？」
というメッセージが表示されます。
環境によってはこの画面はスクリーンリーダーで読み上げされませんが Alt
キーを押しながら Y を押せば、先に進みます。

ポータブル版の作成と利用
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

NVDA のダウンロードパッケージは内部で NVDA そのものが動くように
工夫して作られています。しかし、起動に時間がかかることが欠点です。

USBメモリーなど、持ち運びのできる記憶装置に NVDA
のポータブル版を作成すると、 もっとすばやく NVDA
が起動する環境が手に入り、 しかも設定ファイルと NVDA
のプログラムを一緒に簡単に持ち運べるようになります。
インストールしなくても NVDA を実行できるので、
コンピューターの管理者権限は不要です。

「ポータブル版の作成」で作成する場所を指定するときには、
エディットフィールドにキーボードで場所を入力するのが簡単です。

例えば E ドライブに接続されたまっさらの USB メモリーに 新しく NVDA
フォルダを作るとしたら、

::

   e:\nvda

のように指定すれば E ドライブに NVDA というフォルダーが作られて、
その中に nvda.exe
という実行ファイルと、その他の必要なファイルがコピーされます。
あらかじめフォルダーを作っておく必要はありません。

フォルダーを指定しないで e: のように指定すると E ドライブの直下に NVDA
の数十個のファイルが置かれます。 USB
メモリーにすでにファイルがあった場合には、 すでにあったファイルと NVDA
のファイルが混ざってしまいます。 ご注意ください。

この例のようにポータブル版を作ったとしたら、その起動は Windows
キーを押しながら R の「ファイル名を指定して実行」で行うのが簡単です。
「ファイル名を指定して実行」でエディットフィールドに

::

   e:\nvda\nvda

と入力して Enter キーを押せば、指定した場所の nvda.exe が実行されて、
ポータブル版の NVDA が起動します。

NVDAの起動キーの設定
~~~~~~~~~~~~~~~~~~~~~~~~

インストールされた NVDA を起動するショートカットキーは Ctrl+Alt+N です。
この設定は、Windows デスクトップの NVDA
アイコンのプロパティで変更できます。 デスクトップの NVDA
アイコンにフォーカスを移動して Alt+Enter でプロパティを開き、
「ショートカット」タブの「ショートカットキー(K)」にフォーカスを移動して、
そこで、割り当てたい操作（例えば Ctrl+Alt+Shift+N ）を押します。 最後に
Enter キー（または OK や 適用(A) のボタン）で保存してください。

ようこそ画面
~~~~~~~~~~~~~~~~

NVDA を起動すると最初に「ようこそ画面」が出てきます。
ここには「NVDAキー」と「NVDAメニュー」の説明が書かれています。

書かれている内容を確認しておきましょう。

-  NVDA キーを押しながら N を押す：NVDA メニューを開く

この操作は以下のように表記します：

-  NVDA+N：NVDA メニューを開く

NVDA キーとして Insert キーと「無変換」キーが利用できます。
これらのキーは NVDA が起動しているあいだだけ Alt, Shift, Ctrl のような
いわゆる「修飾キー」として動作します。

つまり NVDA+N という操作を丁寧に書くとこういう手順です。

-  無変換（または Insert）を押して、押さえたままにする
-  アルファベットの N を押してすぐ離す
-  押さえたままにしていた無変換（または Insert）を離す

日本語キーボードのノートパソコンでは Insert キーがなかったり、
押しにくい場所にあることが多いので、 「無変換」を使うのが便利でしょう。

この画面は「ダイアログ」の一種です。
ダイアログはEnterキーで閉じることができます。

閉じてしまった「ようこそ画面」は NVDA
を起動しなおさなくても呼び出すことができます。 NVDA
メニューを開いて、ヘルプ（サブメニュー）から「ようこそ画面」を探し、
Enterで実行するともう一度「ようこそ画面」が開きます。

「ようこそ画面」を閉じると Windows デスクトップにフォーカスが移ります。
NVDA メニューを開いていないときも NVDA はずっと動いています。

入力ヘルプモード
~~~~~~~~~~~~~~~~~~~~

NVDA+1 を押して「入力ヘルプモード」を体験してください。
このモードでは押したキーは実際には入力されたり実行されません。
ただ、どのキーが押されたのかが、音声で説明されます。

「無変換」を押すと NVDA と通知されるので、どのキーが NVDA
キーとして使えるのかもわかります。 また例えば NVDA を押しながら N
を押すと「NVDAメニューの表示」と説明してくれます。
このように入力ヘルプはキーボードの配置だけでなく NVDA
のコマンドの説明にもなっています。 入力ヘルプモードで NVDA+1
を押すと、入力ヘルプモードは終了します。

キーボードを探さないと押せない人は、まず無変換キーと数字の 1
だけ覚えて、
この入力ヘルプモードでキーボード入力の練習をしたらよいでしょう。

また最近のノートパソコンには特別な設定や切り替え操作をしないと
ファンクションキー（f1 から f12）が有効にならないものがあるので、
この入力ヘルプモードで確認するとよいでしょう。

なお Insert キーや無変換キーは NVDA キーとして使われているときにも、
すばやく2回押すと、本来の機能で使うことができます。
このことも入力ヘルプモードで確認できます。

NVDAのキーボード設定
~~~~~~~~~~~~~~~~~~~~~~~~

キーボードにテンキーがない場合はNVDAを「ラップトップ配列」に設定するとよいでしょう。
ここではこのキー配列の設定変更だけをご紹介します。

以下、NVDA制御キーはInsertや無変換キーなど、「ようこそ画面」で説明されたキーを使います。
NVDA 制御キーを押しながら N を押すことを NVDA+N のように表記します。

NVDA を起動して NVDA+N を押すと NVDA メニューが開きます。
下矢印キーを1回押すと「設定(P)」という項目にフォーカスが移動します。
このメニュー項目にはサブメニューがあり、
右矢印キーを押すと「設定(S)」という項目にフォーカスが移動します。 ここで
Enter を押して、NVDAの「設定」ダイアログを開きます。

最初はカテゴリのリストにフォーカスがあるので、
下矢印を何度か押して「キーボード」を見つけて Tab キーを押すと
「キーボード」カテゴリの 最初の項目にフォーカスが移動して、
「キーボード配列 コンボボックス デスクトップ 折り畳み Alt+K」
と読み上げます。

下矢印キーを押すと選択項目が変わって「ラップトップ」と読み上げます。
Enterキーを押すか、フォーカスをOKボタンに移動してスペースキーを押すと
「ラップトップ」の設定が保存されます。

NVDAの音声設定
~~~~~~~~~~~~~~~~~~

NVDAメニューの設定には「音声エンジン」と「音声設定」があります。
音声エンジンは SAPI4, SAPI5 など音声合成ドライバーの切り替えです。
音声設定で声や高さ・速さなどを変更できます。

「速さ」などは「スライダー」という形式の項目で、
数値を視覚的に表現して、値を変更できるようになっています。
キーボードでは矢印キーやPage Up, Page
Downキーで値を増やしたり減らしたりできます。
EndキーとHomeキーで最小値や最大値に変えることもできます。
キーを押すたびに数値を読み上げます。
音声設定のスライダーでは、変更した結果がどんな音声になるのかを確認しながら操作できます。

コンボボックスの「記号読み上げレベル」は、読み上げる情報に含まれる
句読点やカンマ、ピリオド、カッコなどの読み上げかたの指定です。
記号読み上げレベルを「読まない」すると、
例えば「ようこそ画面」の「NVDAへようこそ！」の「感嘆符」を読まないようになります。
記号読み上げレベルは NVDA+P でも変更できます。

チェックボックスの「サポートされている場合自動的に言語を切り替える」は、
JTalk など特定の音声エンジンでのみ有効な項目です。
英語の情報が英語の音声に勝手に切り替わってしまって聞き取りにくい、
という場合はチェックなしにしてください。 例えば Microsoft Word
でこの項目がチェックになっていると半角のアルファベットや数字が
英語の音声に自動的に切り替わってしまいます。 これは半角文字に Microsoft
Word が自動的に「英語」という言語属性をつけてしまうためです。

フォーカス移動のときにAlt+Kのように読み上げますが、
これはアクセラレーターキーと呼ばれる操作のヒントです。
Tabキーでひとつずつ移動しなくても特定の項目へのジャンプやチェック状態の変更ができます。

NVDAメニューから設定「オブジェクト表示」カテゴリで
「オブジェクトのショートカットキーの報告」をチェックなしにすると、
アクセラレーターキーを読み上げなくなるので、説明がすっきりします。

チェックとチェックなしの状態を切り替えるにはスペースキーを押します。

最後に、いろいろな NVDA の設定を初期値に戻す操作を紹介しておきます。

-  NVDA+Ctrl+R ：前回保存された設定に戻す
-  NVDA+Ctrl+R を3回押す：設定をリセットする

