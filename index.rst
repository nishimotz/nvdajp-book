NVDA 日本語版ガイドブック
=========================

第9版 2020年7月12日

NVDA 日本語チーム 西本卓也

この文書は メールマガジン BLPC パソコンメモ
に2013年12月から2014年5月にかけて 掲載された記事を再構成したものです。
Mozilla Firefox, Gmail, Windows 10 の紹介を加筆し、また NVDA
のバージョンアップにあわせて更新しています。

以下は、今後この文書に追加する予定の話題です。

-  `Google Chrome <https://ja.nishimotz.com/chrome>`__
-  `Zoom <https://ja.nishimotz.com/zoom>`__

1 NVDA の基本
-------------

1.1 スクリーンリーダー NVDA の概要
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

NVDA とはどんなソフトなのかご紹介します。 NVDA (Non Visual Desktop
Access) は、無料の Windows 用スクリーンリーダーです。 対応する Windows
のバージョンは 7, 8, 8.1, そして最新の Windows 10 です。
32ビットにも64ビットにも対応しています。また、Windows 8 以降を
タッチ操作に対応した機種で使うときには、タッチで NVDA を操作できます。

NVDA は「フリーソフトウェア」です。英語の FREE
には「無料」のほかに、「自由」という意味もありますが、 NVDA
はこの両方の意味で「フリー」なソフトウェアです。つまり、NVDA
は誰でもどんな目的にでも自由に使ってよく、 また NVDA
のコピーを作って配布することも自由です。

NVDA
の改良版を作って配布することもできますが、この場合は「どのような改良をしたか」という情報（ソースコード）を
隠してはいけない、という決まりです。 だから NVDA
を誰かが改良したら、必ず他の誰かがその改良を引き継ぐことができるのです。
本当は NVDA は無料でなくても、お金をもらって販売してもよいのです。
決まっているのは「開発者が情報の公開を義務付けられている」ということだけです。
この決まりのために「お金を払った人だけが使える」という仕組みが成り立たないだけなのです。

NVDAの最初のバージョンは2006年4月に公開されました。
中心的な開発者はオーストラリアの全盲のプログラマー Michael
Curranさんです。 同じく全盲のプログラマーであるJames
Tehさんも2017年までコア開発者のひとりでした。

彼らは大学でコンピューター科学を学んだ専門家です。その技能を生かして
「視覚障害者が晴眼者と同じコストでコンピューターを利用できる」という理想のために活動を始めたのです。

NVDA
はインターネットで公開されたため、オーストラリア国内だけではなく世界の視覚障害者の関心を集めました。
開発の早い段階から、いろいろな言語に簡単に対応できる国際化の仕組みが取り入れられました。

Web ブラウザの Firefox などを開発している非営利法人 Mozilla 財団が NVDA
の支援を決めたことから、 NVDA の開発は事業として軌道に乗り始めました。

NVDA 開発者の2人を中心に非営利団体 NV Access
が設立され、コンピューター関連の企業や標準化団体、
視覚障害に関する各国の当事者団体の資金援助、個人からの寄付などによって運営されています。

非営利団体の活動として開発されていることは、NVDA
がどんなソフトウェアなのか理解するうえで重要なことです。

ソフトウェアを販売するビジネスの立場では、例えば「どんな機能をつけたらユーザーは
バージョンアップにお金を払ってくれるだろうか」などと考えなくてはなりません。

一方で非営利活動である NVDA の開発では
「視覚障害者の社会参加を促す」あるいは「アクセシビリティに配慮したソフトウェアを増やす」といった目的を
優先することができます。

結果として NVDA
は「他のソフトウェアのバグやお行儀のわるい実装を繕う」のではなく、
「他のソフトウェアの開発者がバグを直したりアクセシビリティの標準規格を守ってくれるように仕向ける」
ことを目指しています。

例えば NVDA は Windows のシステム設定（レジストリ）を書き換えたり
特別なモジュール（デバイスドライバ）をインストールしなくても動くので
「ポータブル版」という使い方ができます。
スクリーンリーダーがそのようなシステムの書き換えやインストールをするのは
「正しい役割分担ではない」と考えているようです。

スクリーンリーダーに対応した特別なアプリケーションの開発ではなく、
晴眼者が使っているアプリケーションをスクリーンリーダーでちゃんと使えるようにする、ということも、
NVDA が担う大事な使命と言えるでしょう。

1.2 NVDA 日本語版の開発
~~~~~~~~~~~~~~~~~~~~~~~

NVDA はひとつのソフトウェアで40以上の言語に対応します。
国際化という観点からも NVDA は「ユニバーサルなスクリーンリーダー」です。

しかし日本語化についてはどうしても今までの国際化の仕組みでは不十分であったため、
日本のボランティアたちが NVDA 日本語版の開発に取り組んできました。

2010年秋になんとか日本語の入力や読み上げができるものが完成したものの、
本当に実用的な日本語対応は2013年5月の 2013.1jp
からだと言ってよいでしょう。
これは前年に香港や台湾のNVDA関係者が資金援助をして行った
東アジア言語対応を NVDA 日本語チームがさらに改良して実現したものです。

点字ディスプレイへの対応に必要な日本語点訳の処理も、
日本語チームが独自に開発したもので、2013.1jp で大きく改善できました。
まだまだ改善すべきところはたくさんありますが NVDA
日本語版の実力はやっと世界に追いついたと言えるでしょう。

NVDA は3か月に1回新しいバージョンが公開されています。 NVDA
日本語版は、NVDA 本家版の新しいバージョンが公開されるたびに
新しいバージョンを公開しています。

1.3 NVDA 日本語版の入手と実行
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1.3.1 NVDA 日本語版の入手
^^^^^^^^^^^^^^^^^^^^^^^^^

NVDA 日本語版は以下のアドレスから直接ダウンロード可能です。

-  https://i.nvda.jp

詳しい情報は NVDA 日本語チームのサイトからご覧ください。

-  https://www.nvda.jp

1.3.2 NVDAとその他のスクリーンリーダー
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ダウンロードしたファイル（ダウンロードパッケージ）を実行すると NVDA
が動作して、 NVDA が表示した画面そのものを読み上げます。

すでに他のスクリーンリーダーが動作している場合には、
複数のスクリーンリーダーが同時に動いてしまう状態になるかも知れません。

例えば Windows 「コンピューターの簡単操作センター」に備わっている
「ナレーター」という機能もスクリーンリーダーの一種です。

NVDA
に限らず、複数のスクリーンリーダーを同時に動作させることはお勧めできません。
どちらのスクリーンリーダーも正常に操作できなくなることがあります。ご注意ください。

1.3.3 NVDA の終了方法
^^^^^^^^^^^^^^^^^^^^^

ダウンロードパッケージが開くウィンドウを閉じても NVDA は終了しません。
NVDA 日本語版を止める方法を紹介しておきます。

-  キーボードで Insert キーを押しながらアルファベットの Q を押す

-  無変換キーを押しながらアルファベットの Q を押す

このいずれかの操作で終了ダイアログが表示されます。 終了ダイアログから
Enter キーで NVDA を終了できます。 マウスで Windows
の通知領域（タスクトレイ）を操作できる場合は、 NVDA
のアイコンをクリックして NVDA メニューから「終了」を選ぶことができます。

1.3.4 NVDAのインストール
^^^^^^^^^^^^^^^^^^^^^^^^

ダウンロードパッケージの機能を紹介します。

最初は「使用許諾契約」にフォーカスがあります。
ここには英語の文章が書かれていますが、
その大まかな意味はこのガイドブックで最初に紹介した内容です。
使用許諾契約から Tab
キーで「同意する」というチェックボックスに移動して、
スペースを押してチェックボックスをチェックしてください。 Tab
キーで以下の3個のボタンに移動できるようになります。

-  このコンピューターにインストール
-  ポータブル版を作成
-  動作を継続（そのまま NVDA を使う）

コンピューターに NVDA をインストールすることを選ぶと、
次の画面に「ログオン画面で NVDA
を使用」というチェックボックスがあります。
すでに他のスクリーンリーダーでログオン画面の読み上げを行っているときには、
このチェックボックスをチェックなしにしておくとよいでしょう。

インストールを完了させるには管理者権限が必要です。
「ユーザーアカウント制御」というウィンドウに
「次のプログラムにこのコンピューターへの変更を許可しますか？」
というメッセージが表示されます。
環境によってはこの画面はスクリーンリーダーで読み上げされませんが Alt
キーを押しながら Y を押せば、先に進みます。

1.3.5 ポータブル版の作成と利用
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

NVDA のダウンロードパッケージは内部で NVDA そのものが動くように
工夫して作られています。しかし、起動に時間がかかることが欠点です。

USBメモリーなど、持ち運びのできる記憶装置に NVDA
のポータブル版を作成すると、 もっとすばやく NVDA
が起動する環境が手に入り、 しかも設定ファイルと NVDA
のプログラムを一緒に簡単に持ち運べるようになります。
インストールしなくても NVDA を実行できるので、
コンピューターの管理者権限は不要です。

「ポータブル版の作成」で作成する場所を指定するときには、
エディットフィールドにキーボードで場所を入力するのが簡単です。

例えば E ドライブに接続されたまっさらの USB メモリーに 新しく NVDA
フォルダを作るとしたら、

::

   e:\nvda

のように指定すれば E ドライブに NVDA というフォルダーが作られて、
その中に nvda.exe
という実行ファイルと、その他の必要なファイルがコピーされます。
あらかじめフォルダーを作っておく必要はありません。

フォルダーを指定しないで e: のように指定すると E ドライブの直下に NVDA
の数十個のファイルが置かれます。 USB
メモリーにすでにファイルがあった場合には、 すでにあったファイルと NVDA
のファイルが混ざってしまいます。 ご注意ください。

この例のようにポータブル版を作ったとしたら、その起動は Windows
キーを押しながら R の「ファイル名を指定して実行」で行うのが簡単です。
「ファイル名を指定して実行」でエディットフィールドに

::

   e:\nvda\nvda

と入力して Enter キーを押せば、指定した場所の nvda.exe が実行されて、
ポータブル版の NVDA が起動します。

1.4 NVDAの起動キーの設定
~~~~~~~~~~~~~~~~~~~~~~~~

インストールされた NVDA を起動するショートカットキーは Ctrl+Alt+N です。
この設定は、Windows デスクトップの NVDA
アイコンのプロパティで変更できます。 デスクトップの NVDA
アイコンにフォーカスを移動して Alt+Enter でプロパティを開き、
「ショートカット」タブの「ショートカットキー(K)」にフォーカスを移動して、
そこで、割り当てたい操作（例えば Ctrl+Alt+Shift+N ）を押します。 最後に
Enter キー（または OK や 適用(A) のボタン）で保存してください。

1.5 ようこそ画面
~~~~~~~~~~~~~~~~

NVDA を起動すると最初に「ようこそ画面」が出てきます。
ここには「NVDAキー」と「NVDAメニュー」の説明が書かれています。

書かれている内容を確認しておきましょう。

-  NVDA キーを押しながら N を押す：NVDA メニューを開く

この操作は以下のように表記します：

-  NVDA+N：NVDA メニューを開く

NVDA キーとして Insert キーと「無変換」キーが利用できます。
これらのキーは NVDA が起動しているあいだだけ Alt, Shift, Ctrl のような
いわゆる「修飾キー」として動作します。

つまり NVDA+N という操作を丁寧に書くとこういう手順です。

-  無変換（または Insert）を押して、押さえたままにする
-  アルファベットの N を押してすぐ離す
-  押さえたままにしていた無変換（または Insert）を離す

日本語キーボードのノートパソコンでは Insert キーがなかったり、
押しにくい場所にあることが多いので、 「無変換」を使うのが便利でしょう。

この画面は「ダイアログ」の一種です。
ダイアログはEnterキーで閉じることができます。

閉じてしまった「ようこそ画面」は NVDA
を起動しなおさなくても呼び出すことができます。 NVDA
メニューを開いて、ヘルプ（サブメニュー）から「ようこそ画面」を探し、
Enterで実行するともう一度「ようこそ画面」が開きます。

「ようこそ画面」を閉じると Windows デスクトップにフォーカスが移ります。
NVDA メニューを開いていないときも NVDA はずっと動いています。

1.6 入力ヘルプモード
~~~~~~~~~~~~~~~~~~~~

NVDA+1 を押して「入力ヘルプモード」を体験してください。
このモードでは押したキーは実際には入力されたり実行されません。
ただ、どのキーが押されたのかが、音声で説明されます。

「無変換」を押すと NVDA と通知されるので、どのキーが NVDA
キーとして使えるのかもわかります。 また例えば NVDA を押しながら N
を押すと「NVDAメニューの表示」と説明してくれます。
このように入力ヘルプはキーボードの配置だけでなく NVDA
のコマンドの説明にもなっています。 入力ヘルプモードで NVDA+1
を押すと、入力ヘルプモードは終了します。

キーボードを探さないと押せない人は、まず無変換キーと数字の 1
だけ覚えて、
この入力ヘルプモードでキーボード入力の練習をしたらよいでしょう。

また最近のノートパソコンには特別な設定や切り替え操作をしないと
ファンクションキー（f1 から f12）が有効にならないものがあるので、
この入力ヘルプモードで確認するとよいでしょう。

なお Insert キーや無変換キーは NVDA キーとして使われているときにも、
すばやく2回押すと、本来の機能で使うことができます。
このことも入力ヘルプモードで確認できます。

1.7 NVDAのキーボード設定
~~~~~~~~~~~~~~~~~~~~~~~~

キーボードにテンキーがない場合はNVDAを「ラップトップ配列」に設定するとよいでしょう。
ここではこのキー配列の設定変更だけをご紹介します。

以下、NVDA制御キーはInsertや無変換キーなど、「ようこそ画面」で説明されたキーを使います。
NVDA 制御キーを押しながら N を押すことを NVDA+N のように表記します。

NVDA を起動して NVDA+N を押すと NVDA メニューが開きます。
下矢印キーを1回押すと「設定(P)」という項目にフォーカスが移動します。
このメニュー項目にはサブメニューがあり、
右矢印キーを押すと「設定(S)」という項目にフォーカスが移動します。 ここで
Enter を押して、NVDAの「設定」ダイアログを開きます。

最初はカテゴリのリストにフォーカスがあるので、
下矢印を何度か押して「キーボード」を見つけて Tab キーを押すと
「キーボード」カテゴリの 最初の項目にフォーカスが移動して、
「キーボード配列 コンボボックス デスクトップ 折り畳み Alt+K」
と読み上げます。

下矢印キーを押すと選択項目が変わって「ラップトップ」と読み上げます。
Enterキーを押すか、フォーカスをOKボタンに移動してスペースキーを押すと
「ラップトップ」の設定が保存されます。

1.8 NVDAの音声設定
~~~~~~~~~~~~~~~~~~

NVDAメニューの設定には「音声エンジン」と「音声設定」があります。
音声エンジンは SAPI4, SAPI5 など音声合成ドライバーの切り替えです。
音声設定で声や高さ・速さなどを変更できます。

「速さ」などは「スライダー」という形式の項目で、
数値を視覚的に表現して、値を変更できるようになっています。
キーボードでは矢印キーやPage Up, Page
Downキーで値を増やしたり減らしたりできます。
EndキーとHomeキーで最小値や最大値に変えることもできます。
キーを押すたびに数値を読み上げます。
音声設定のスライダーでは、変更した結果がどんな音声になるのかを確認しながら操作できます。

コンボボックスの「記号読み上げレベル」は、読み上げる情報に含まれる
句読点やカンマ、ピリオド、カッコなどの読み上げかたの指定です。
記号読み上げレベルを「読まない」すると、
例えば「ようこそ画面」の「NVDAへようこそ！」の「感嘆符」を読まないようになります。
記号読み上げレベルは NVDA+P でも変更できます。

チェックボックスの「サポートされている場合自動的に言語を切り替える」は、
JTalk など特定の音声エンジンでのみ有効な項目です。
英語の情報が英語の音声に勝手に切り替わってしまって聞き取りにくい、
という場合はチェックなしにしてください。 例えば Microsoft Word
でこの項目がチェックになっていると半角のアルファベットや数字が
英語の音声に自動的に切り替わってしまいます。 これは半角文字に Microsoft
Word が自動的に「英語」という言語属性をつけてしまうためです。

フォーカス移動のときにAlt+Kのように読み上げますが、
これはアクセラレーターキーと呼ばれる操作のヒントです。
Tabキーでひとつずつ移動しなくても特定の項目へのジャンプやチェック状態の変更ができます。

NVDAメニューから設定「オブジェクト表示」カテゴリで
「オブジェクトのショートカットキーの報告」をチェックなしにすると、
アクセラレーターキーを読み上げなくなるので、説明がすっきりします。

チェックとチェックなしの状態を切り替えるにはスペースキーを押します。

最後に、いろいろな NVDA の設定を初期値に戻す操作を紹介しておきます。

-  NVDA+Ctrl+R ：前回保存された設定に戻す
-  NVDA+Ctrl+R を3回押す：設定をリセットする

2 ブラウズモード
----------------

2.1 ユーザーガイドを読んでみよう
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Windows
はもともとキーボードでいろいろな操作ができるようになっていますが、 NVDA
は独自に「文字を読むための操作」を付け加えています。
これは「ブラウズモード」と呼ばれています。
ブラウズとは「閲覧」という意味です。
「Webブラウザー」という言葉はよくご存じと思いますが、
これは「Webを閲覧するためのもの」という意味です。
NVDAの「ブラウズ」はWebブラウザーだけでなくいろいろな場面で使えます。

NVDAメニューの「ユーザーガイド」を開くとブラウズモードの操作が使えます。
NVDA
日本語版を起動して、NVDAメニューを開き「ヘルプ」「ユーザーガイド」を
選んでください。

アクセラレーターキーを使うと、以下のように操作できます：

-  NVDA+N を押す
-  アルファベット H を押す
-  アルファベット U を押す

開くとすぐに読み上げが始まりますが、Shift を押すと音声が止まります。
このユーザーガイドは Alt+Tab で他のアプリケーションから切り替えることが
でき、Alt+F4 で終了できます。

まずテキスト（文字）を確認する操作です。
「キーボード設定」「キーボードレイアウト」の設定によって
操作が違うので、最初にまとめます。

ラップトップ配列：

-  NVDA+左矢印：前の文字に移動
-  NVDA+ピリオド：現在の文字を読み上げ
-  NVDA+右矢印：次の文字に移動
-  NVDA+上矢印：前の行に移動
-  NVDA+Shift+ピリオド：現在の行を読み上げ
-  NVDA+下矢印：次の行に移動

デスクトップ配列：

-  テンキー1：前の文字に移動
-  テンキー2：現在の文字を読み上げ
-  テンキー3：次の文字に移動
-  テンキー7：前の行に移動
-  テンキー8：現在の行を読み上げ
-  テンキー9：次の行に移動

操作を覚えるためには前後左右など位置関係をイメージするとよいでしょう。
以下で具体的に説明します。 NVDAキーは「無変換」または Insert
キーでしたね。

ラップトップ配列

-  NVDA+左矢印：前の文字に移動

デスクトップ配列

-  テンキー1：前の文字に移動

これを押すと「左 大文字 エヌ」と読み上げます。
同じ操作を何度繰り返しても「左 大文字 エヌ」と読み上げます。
これはいま注目している文字がすでに行の左端にあり、これ以上左に移動できないからです。
また「大文字」はアルファベットのエヌが大文字であることを示します。
「音声設定」「大文字にビープ音を付ける」がチェックされている場合は
「大文字」と読むかわりにピッという音が鳴ります。

ラップトップ配列

-  NVDA+ピリオド：現在の文字を読み上げ

デスクトップ配列

-  テンキー２：現在の文字を読み上げ

これを押すとやはり「大文字 エヌ」と読み上げます。
NVDAキーを押したままピリオド（ラップトップ配列）
またはテンキー２（デスクトップ配列）を「ポン、ポン」と2回押すと 「半角
英字 大文字 エヌ」と読み上げます。

ラップトップ配列

-  NVDA+右矢印：次の文字に移動

デスクトップ配列

-  テンキー３：次の文字に移動

これを押すと「大文字 ブイ」と読み上げます。 この操作を繰り返すと「大文字
デー、大文字 エー、スペース、に、ぜろ、いち、ご」のように
1文字ずつ表示されている情報が確認できます。

「注目している文字」を左右に移動する操作を覚えました。 このときに
Windows のカーソルやマウスポインタは一切移動しません。
開いているウィンドウの内容を壊したり書き換えたりすることもありません。
この操作が NVDA の「レビューカーソル」の移動です。

今度はレビューカーソルを1行ずつ動かしてみます。

ラップトップ配列

-  NVDA+上矢印：前の行に移動

デスクトップ配列

-  テンキー７：前の行に移動

これを押すと 「トップ 見出し レベル1 NVDA 2016.2jp ユーザーガイド」
と読み上げます。 繰り返しても読み上げる内容は同じです。
これは、レビューカーソルが一番上の行にあって、
その行が「見出しレベル1」という種類の情報で、 内容が「NVDA 2016.2jp
ユーザーガイド」であることを示しています。

ラップトップ配列

-  NVDA+Shift+ピリオド：現在の行を読み上げ

デスクトップ配列

-  テンキー８：現在の行を読み上げ

これを押すと 「見出し レベル1 NVDA 2016.2jp ユーザーガイド」
と読み上げます。

ラップトップ配列

-  NVDA+下矢印：次の行に移動

デスクトップ配列

-  テンキー９：次の行に移動

これを押すと 「見出し レベル2 目次」 と読み上げます。

現在の行の読み上げ
（ラップトップ配列：NVDA+Shift+ピリオド、デスクトップ配列：テンキー８）
を2回続けて押すと 「もく、じ」のように1文字ずつ区切って読み上げます。

また3回続けて押すと 「もく、めじるしのめ、つぎ、じかいのじ」
のように文字を詳しく説明します。

おまけですが NVDA+F を押すと 「Times New Roman 24pt 太字 ベースライン
中央揃え」 のように現在の行の書式を説明します。

これが「何かを読む操作」の基本です。
今回の例では、ただ矢印キーを押したときにも
似たような動きをするのですが、これはたまたま動いているアプリケーションが
矢印キーで操作できて、レビューカーソルも自動的に一緒に移動して
いるからです。
アプリケーションの操作ではなくNVDAの機能で文字や文章を確認できる、
ということをご理解ください。

このブラウズモードにはもっとたくさんの操作方法があります。
アルファベットの H を押すと「次の見出し」つまり下に向かって移動します。
また Shift+H を押すと「前の見出し」つまり上に向かって移動します。
この「見出しジャンプ」機能と、行単位や文字単位の移動だけでも、
ひととおりユーザーガイドを読むことができるでしょう。

ここでご紹介した操作はユーザーガイド 5.5. テキストの確認 で
説明されています。

-  `ユーザーガイド 5.5.
   テキストの確認 <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#ReviewingText>`__

また、ブラウズモードになっているときに NVDA+1
で入力ヘルプモードに切り替えると、
ブラウズモードでのキーの機能を知ることができます。 例えば数字キー 1
を押すと「1 次の見出し1へ移動」のように説明されます。

2.2 ブラウズモードを使いこなす
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ブラウズモードの操作は Internet Explorer や Mozilla Firefox, Google
Chrome などの ウェブブラウザ、Adobe Reader
など、さまざまな場面で使えます。

Windows 10 で導入された Microsoft Edge ブラウザへの対応は、 NVDA 2017.2
で大幅に改善されました。

さきほどブラウズモードでの行や文字単位の移動、 H
で「次の見出し」に移動、といった操作を説明しました。
アルファベット1文字などの入力による移動を
「1文字ナビゲーション」と呼んでいます。

例えば L でリスト、I でリスト項目、T でテーブル、 F
でフォームフィールド（テキスト入力欄やチェックボックスなど）、 G
で画像にジャンプします。

Shift と一緒に押すと逆方向に移動します。

利用できる操作の一覧はユーザーガイド 6.1. 1文字ナビゲーション を
参照してください。

-  `ユーザーガイド 6.1.
   1文字ナビゲーション <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#SingleLetterNavigation>`__

テーブルの中では下矢印を押すと１行１列、１行２列、１行３列、のように移動し、
右端の列から折り返して２行１列、のように進みます。

列を移動せずに前後の行に移動したいときなどは、以下の操作が利用できます。

-  Ctrl+Alt+左矢印：前の列に移動
-  Ctrl+Alt+右矢印：次の列に移動
-  Ctrl+Alt+上矢印：前の行に移動
-  Ctrl+Alt+下矢印：次の行に移動

ブラウズモードに対応したドキュメントは、見出しによって階層構造を
作ることができ、その構造は「要素リスト」で確認できます。

要素リストは NVDA+F7 で開くダイアログです。

「ユーザーガイド」のブラウズ中に要素リストを開くと、ツリービューには
リンクがはられた項目、例えば目次でページ内リンクがついた章や
節のタイトルが並びます。
上下の矢印キーで要素を移動して、左矢印で折りたたむ、
右矢印で展開する、といった操作ができます。

項目に移動してエンターキーを押すと、ドキュメントの対応する場所に
ジャンプできます。

このツリービューから Shift+Tab で「種別」というグループに移動すると
「リンク」「見出し」「ランドマーク」のラジオボタンがあり、
切り替えるとツリービューの内容が更新されます。

またフィルター機能を使うと、特定の文字列を含む項目だけを表示できます。

2.3 ブラウズモードの設定
~~~~~~~~~~~~~~~~~~~~~~~~

NVDA メニューの「設定」「ブラウズモード」の項目について
すこし補足します。

まず「1行の最大文字数」です。
この値の初期値は100文字で、10から250までの数字が指定できます。
画面で横の幅に収まらないたくさんの文字を含む要素は、改行されて
複数の行として表示されます。
しかしブラウズモードで行の移動をするときには、
画面の幅とは関係なく、この「1行の文字数」で区切られます。

次に「サポートされている場合画面レイアウトを使用」という
設定について説明します。
例えば以下のようにチェックボックスが横に2個並んでいるとします。

興味のある国

アメリカ （チェックボックス） イギリス （チェックボックス）

「画面レイアウトを使用」の場合は下矢印キーを押すごとに

-  「興味のある国」
-  「アメリカ チェックボックス チェックなし
-  イギリス チェックボックス チェックなし」

のように区切られます。

「画面レイアウトを使わない」では、下矢印キーを押すごとに

-  「興味のある国」
-  「アメリカ」
-  「チェックボックス チェックなし」
-  「イギリス」
-  「チェックボックス チェックなし」

のように区切られます。
（どのようにサイトが制作されているかによって実際の動作は
異なる場合があります） 必要に応じて使い分けてください。

画面レイアウトの「使用」「使わない」は NVDA+V を押して
切り替えることもできます。

最後に「フォーカスの変化を追跡する自動フォーカスモード」
について説明します。

キーボードの H を押して見出しジャンプするのではなく、
エディットフィールドに h という文字を入力したいことがあります。
このような場合には「フォーカスモード」に切り替えて、キー入力を
ウェブブラウザに対して行う必要があります。
必要に応じて自動的にこの切替をする機能が 「自動フォーカスモード」です。

フォーカスモードに切り替わるときには「ガシャ」という音が、
ブラウズモードに戻るときには「ポン」という音が鳴ります。 MSN, Yahoo,
Google のような検索サイトを開いて Tab
キーで移動していると、検索キーワードの入力欄でこのような
音を聞くことができます。

手動でのフォーカスモードの切り替えは NVDA+スペース で可能です。
エディットフィールドで NVDA+スペースを繰り返し押すと、
「ガシャ」「ポン」「ガシャ」「ポン」とモードが交互に切り替わります。

フォーカスモードは文字入力だけでなく、コンボボックスの操作などでも使われます。

例えばコンボボックスで下矢印キーを押しても、
ブラウズモードのままだとひとつ下の行や要素に移動してしまいます。

「コンボボックス 折りたたみ」のように読み上げられる場所で
NVDA+スペースを押して「ガシャ」という音が聞こえてから
下矢印と上矢印を押せば、コンボボックスの選択を変えることができます。

変更が終わったらブラウズモードに戻すために、 もう一度
NVDA+スペースを押して「ポン」という音が鳴ることを 確認してください。

2.4 ブラウズモードに関係する設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ブラウズモードに影響するその他の設定として、
まず「書式情報」の中には以下のような項目があります。

-  フォント名、フォントサイズ、フォント属性、配置、色、
   校閲者による更新、スタイル、スペルエラー、
   ページ番号、行番号、行インデント、
   テーブル、テーブルの行／列見出し、テーブルのセル番地、リンク、
   見出し、リスト、引用、ランドマーク、フレーム、クリック可能

チェックされた項目は移動するたびに読み上げるので、不要な項目は
チェックなしにするとよいでしょう。 一部の項目はウェブブラウザではなく
Adobe Reader, Word, Excel, メモ帳などで有効です。
無効にした項目の情報には NVDA+Tab や NVDA+F で
確認できるものもあります。

また Internet Explorer ではリンクされたファイルのURLが、
ツールチップという小さなウィンドウで表示され、
それが読み上げられることがあります。
「オブジェクト表示」「ツールチップの報告(T)」の設定で、
このような情報を読み上げさせたり無視させたりできます。

NVDA の操作や設定は、すべてのアプリケーションを通じて
なるべく共通な方法で行うようになっているので、
最初は分かりにくいかも知れませんが、いろいろ試していただけると、
きっと便利な使い方が見つかると思います。

3 Firefox を使う
----------------

3.1 Firefox 基本編
~~~~~~~~~~~~~~~~~~

3.1.1 Mozilla Firefox の紹介
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ここから Mozilla Firefox という Web ブラウザの紹介をします。 Firefox
（ファイヤーフォックス）は NVDA ユーザーにお勧めの Web ブラウザです。
Firefox は Mozilla
（モジラ）という非営利法人によって開発され、無料で公開されています。

-  `Mozilla Firefox の Web
   サイト <https://www.mozilla.org/ja/firefox/>`__

ここに「Firefox をダウンロード」というリンクがあり、
セットアップのためのファイルをダウンロードできます。

Firefox そのものは非常にバージョンアップの早いブラウザで、
6週間ごとにバージョンがひとつずつ増えています。
これは、インターネットの新しい技術を開発したり、不具合を修正したりすることを、
できるだけ頻繁に行うためです。

Firefox のバージョンアップはほとんど自動的に行われますし、
使い方が大きく変わることも滅多にありません。 使っているあいだに Firefox
のバージョンを意識する必要はほとんどありません。

NVDA と Firefox はいろいろな意味で似ているだけでなく、
お互いに協力し合いながら開発されているので、 Web
のアクセシビリティについての最新の技術が、 NVDA と Firefox
の組み合わせにだけ対応している、ということも少なくありません。

2017年から2018年にかけて Firefox は大きなバージョンアップを行い、
一時的に NVDA で使いにくい状況が起きていました。 現在は最新の Firefox と
NVDA の組み合わせが問題なく使えます。

3.1.2 Firefox のセットアップ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

まずお使いの Windows に Firefox をインストールしてください。
「セットアップの種類」は「標準インストール」で大丈夫です。

「Firefox をインストールする準備ができました」という画面で 「Firefox
を既定のブラウザとして使用する」 という項目があります。

ここでは、コンピューターの設定をなるべく変更しないで、 ただ Firefox
のインストールだけをしたいと思います。
この項目が有効になっていたら、いったん「チェックなし」に変更して、
それから「インストール」のボタンを押しましょう。

インストールにはすこし時間がかかりますが、やがて 「Mozilla Firefox
のセットアップを完了します」という画面になり、 「今すぐ Firefox
を起動」という項目が有効になった状態で、
フォーカスが「完了」のボタンにあります。

初めてインストールしたときには、 この「完了」を押すとすぐに Firefox
の「設定移行ウィザード」が開始します。 Internet Explorer
から「お気に入り」やパスワードなどの情報を移行することができます。

続いて Firefox が起動して、
「既定のブラウザの設定」というダイアログが表示されます。

::

   「Firefox は現在既定のブラウザに設定されていません。
   既定のブラウザに設定しますか？」

という質問です。
このコンピューターのブラウザの設定を変更したくなければ、
「Firefoxを起動するとき毎回既定のブラウザを確認する」
のチェックを外して、このダイアログの「いいえ」のボタンを押すとよいでしょう。

起動の方法をちゃんと確認したいので、いったん Firefox を終了しましょう。
Alt+F4
を押すとすぐに終了せず、次のようなダイアログが出ることもあります。

::

   「タブを閉じる確認
   複数 (2) のタブを閉じようとしています。
   すべてのタブを閉じてよろしいですか？」

ここで「OK」を押せば Firefox は無事に終了します。
「タブ」の使い方は後でじっくり練習しましょう。

3.1.3 Firefox の起動とアドレス入力
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

スタートメニューやスタート画面で Firefox を起動するには、 Windows
キーを押して、
半角全角キーを押して日本語入力を「変換停止」の状態にして、
アルファベットで firefox と入力します。 もしかすると途中まで入力すると

「モジラ・ファイヤフォックス・アプリ」 または 「プログラム グループ 展開
モジラ・ファイヤフォックス」

と読み上げられるかも知れませんが、その場合は、そこで入力を中断してもかまいません。
Enter キーを押すと Firefox が起動します。

「Mozilla Firefox スタートページ ドキュメント エディット
オートコンプリート 空行」

のように読み上げられます。

これは「Mozilla Firefox スタートページ」というドキュメント（文書）で、
ネットにつながなくても Firefox に最初から入っている内容です。

ここから Google の検索がすぐにできるように、
キーワードを入力するエディットボックスと、
検索を実行するボタンが用意されています。

Tab キーでどんどんフォーカスを移動していくと、
ページの内容ではない（画面の一番上に表示されている）
要素にもフォーカスが移動します。次のようなものです：

「ブラウザタブ ツールバー タブコントロール モジラ・ファイヤフォックス
スタートページ タブ 選択」

「ナビゲーションツールバー ツールバー URLまたは検索語句を入力します
コンボボックス 折りたたみ エディット オートコンプリート 空行」

「Google で検索します コンボボックス 折りたたみ エディット
オートコンプリート 空行」

では Firefox のショートカットをひとつ覚えましょう：

-  Alt+D：ナビゲーションツールバーに移動 （または Ctrl+L も使えます）

それから一般的な Windows アプリケーションの作法ですが、
以下も確認しておくとよいでしょう。

-  Alt キーを1回ポンと押す：アプリケーションのメニューが開いて、
   上下左右の矢印キーでメニュー項目の選択ができる
-  Alt+スペース：システムメニュー（「元のサイズに戻す」「最小化」など）が開く
-  Alt+F4：アプリケーション(Firefox)の終了

Alt+D でナビゲーションツールバーに移動したあとで、
開きたいサイトのアドレスを入力して Enter キーを押すと
入力したアドレスのサイトを開くことができます。

日本語入力は「変換停止」の状態なので、ここで

::

   www.nvda.jp

と入力してください。
入力の途中で「オートコンプリート」という機能がはたらいて、
まだ入れていない文字をどんどん読み上げるかも知れませんが、
あえてそれは聞かないようにして、自分が入力したい文字を確実に
打ち込むように心がけてください。

NVDA+Tab を押すと以下のように確認できるはずです。

「エディット フォーカス オートコンプリート www.nvda.jp」

間違えたので最初から入力をしなおしたい、というときには、
まず入力した文字をすべて選択して削除しておくとよいでしょう。 例えば
wwe.nvda.jp と入れてしまったとすると、

-  Ctrl+A を押す： 「wwe.nvda.jp 選択」

-  Delete を押す： 「選択項目削除」

このほかに、左右の矢印キーで1文字ずつ移動して、バックスペースや
デリートの操作を行って、間違えた文字を直すこともできます。

3.1.4 Firefox でドキュメントを読む
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

ナビゲーションツールバーに入れたアドレスが正しいようなら Enter
を押してください。

「NVDA日本語版 ダウンロードと説明」
というページが開いて、読み上げが始まります。
最後まで聞かなくてよいので、 Shift
キーを押して、読み上げを止めてください。

NVDA
メニューの設定「ブラウズモード」「ページ読み込み時に自動的に読み上げる」
をチェックなしにすると、ページを読み込んだときに自動的に読み上げなくなります。

なお、ナビゲーションツールバーに入れるアドレスの先頭には 本当は http://
をつける必要がありますが、
最近のブラウザはこれを省略できるようになっています。

テキストを確認する操作がこの状態で使えます。 いくつか復習しましょう。

ラップトップ配列：

-  NVDA+上矢印：前の行に移動
-  NVDA+Shift+ピリオド：現在の行を読み上げ
-  NVDA+下矢印：次の行に移動

デスクトップ配列：

-  テンキー7：前の行に移動
-  テンキー8：現在の行を読み上げ
-  テンキー9：次の行に移動

一文字ナビゲーションも使えます。

Firefox では上下の矢印キーはフォーカスやキャレットを移動しながら
「前の行」「次の行」に移動する操作として使えます。

ドキュメントを連続して読む操作を紹介します：

ラップトップ配列：

-  NVDA+A：すべて読み上げ
-  NVDA+L：現在キャレットのある行の読み上げ

デスクトップ配列：

-  NVDA+下矢印：すべて読み上げ
-  NVDA+上矢印：現在キャレットのある行の読み上げ

キーボード設定「すべて読み上げで流し読みを許可」をチェック（有効に）しておくと、
「すべて読み上げ」の途中で一文字ナビゲーションの操作をしても、
ジャンプして読み上げを止めるのではなく、ジャンプしたところから
自動的に読み上げを再開します。

3.1.5 ドキュメントの中でリンクを探す
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

このページの中で「チュートリアル」という見出しの中にある
「Web閲覧の操作」 というリンクを探しましょう。

その方法はいろいろありますが、
使うのはどれも「ブラウズモード」の説明で紹介した機能です。

まず、1文字ナビゲーションで K を押し続けていけば、 「Web閲覧の操作 未読
リンク」 という項目になんとかたどり着くことができます。 行きすぎたら
Shift+K で戻ってください。 まだリンクを開かないでください。

なお、もし過去にこのリンク先のドキュメントを開いたことがあれば
「未読」ではなく「既読」と通知されます。

リンクを探す2番目の方法です。
見出し「チュートリアル」を探せば、ちょっと近道ができます。

具体的には H を押し続けて「チュートリアル 見出し レベル2」を見つけて、
そこから下矢印キーを3回押せば 「未読 リンク Web閲覧の操作」
が見つかります。

リンクの探し方の3番目は「要素リスト」を使う方法です。 NVDA+F7
を押して、要素リストのダイアログを開きます。

種別「リンク」になっているので、そのままツリービューを
下矢印キーでたどっていくと 「Web閲覧の操作 21の44 レベル0」
のような項目が見つかります。

Tabキーを3回押して「移動(M)ボタン」でスペースを押すと、 「Web閲覧の操作
未読 リンク」 に移動できています。

4番目は「NVDAのページ内検索」を使う方法です。

-  NVDA+Ctrl+F：ブラウズモードのドキュメントを検索

エディットボックスに 「Web閲覧」 と入力

Tab を押す 「OK(O)ボタン」

スペースを押す

文字を入力するところを丁寧に書くと：

-  半角全角キー
-  「変換停止」
-  Shift+W e b
-  Enter
-  「ウェブ」
-  半角全角キー
-  「文字変換」
-  e t u r a n n スペース
-  「エツランスルノエツ カンランノラン」
-  Enter
-  「閲覧」
-  半角全角キー
-  「変換停止」

スペースを押すと「検索」ダイアログが閉じて、 「未読 リンク
Web閲覧の操作」
と読み上げます。これでフォーカスはこの要素に移動した状態になっています。
（NVDA+Tabで確認できます）

ドキュメントにこのキーワードが2回以上出てくるときのために、
文字列を入れ直さずに検索を繰り返すことができます。

-  NVDA+F3：現在の場所から同じ検索を繰り返す
-  NVDA+Shift+F3：現在の場所から逆方向に同じ検索を繰り返す

今回のドキュメントでは1回しか文字列が出てこないので 「検索エラー
ダイアログ テキスト Web閲覧 は見つかりません」
というメッセージが出てしまいます。
これは、見つかった場所からさらにもう1回探そうとしたのですが、
2回目は見つかりませんよ、という意味です。

3.1.6 フォーカスモードとブラウズモード
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

いままでの操作で NVDA のフォーカスモードが重要なので、補足しておきます。
NVDA+スペース を押すたびに「ガシャ」「ポン」「ガシャ」「ポン」と
モードが切り替わる、という説明は覚えていますか？

「ポン」の状態（ブラウズモード）にしないと1文字ナビゲーション、 例えば K
を押して「次のリンクに移動」する機能は使えません。

「ガシャ」の状態（フォーカスモード）では、NVDA ではなく Firefox
がキー入力を受け取って動作します。 Firefox
がキー入力を特別な機能に割り当てている場合もあります。

例えばフォーカスモードで上下矢印キーを押すと画面は上下にスクロールします。
このときに読み上げはありません。
上下矢印キーで項目を移動して読み上げるのは NVDA
のブラウズモードの機能なので、 「ポン」の状態に戻す必要があるのです。

3.1.7 Firefox のページ内検索とアクセシビリティ機能
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

実はリンクを探す5番目の方法として「Firefox のページ内検索」があります。
練習は省略しますが、NVDA のフォーカスモードで、 シングルクオート ‘
やスラッシュ / を押すと この Firefox
の「クイック検索」のバーが表示されてしまい、
思い通りに操作できなくなる可能性があります。 Esc
を押すとクイック検索バーは閉じるので、落ち着いて操作してください。

Firefox のアクセシビリティ機能として
「キー入力時に検索を開始する」というオプションもあります。
このオプションが有効で、さらに NVDA がフォーカスモードだと、
シングルクオートやスラッシュを押さなくても、
なにかキー入力をするだけで「クイック検索」が始まって、 Firefox
のページ内検索が動きだします。

同じく Firefox のアクセシビリティ機能ですが F7
キーを押すと「キャレットブラウズ」のモードを切り替えることができます。
キャレットブラウズモードではキャレットは常に表示され、
矢印キーでキャレットを上下左右に移動できます。
ちょうどテキストエディタやワードプロセッサーで、
読み取り専用のドキュメントを操作しているような感じになります。

これらの Firefox のアクセシビリティ機能は、いちおう知っておくと、 NVDA
との組み合わせでのトラブルを解決しやすくなると思います。 しかし NVDA
のフォーカスモードで Firefox
のキャレットブラウズやクイック検索を使うよりも、 まずは NVDA
のブラウズモードの操作に慣れることをお勧めします。

3.1.8 ページの先頭に移動する
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

今回のリンクを探す操作を、何度もやり直して練習したい人のために 以下の
Firefox のショートカットもご紹介しておきます：

-  Ctrl+Home：ページの先頭に移動

この操作は、フォーカスモードではただ一番上にスクロールするだけですが、
ブラウズモードで実行すればページ先頭要素の読み上げをしてくれます。

3.1.9 タブを活用する
^^^^^^^^^^^^^^^^^^^^

さて、たどり着いた「Web閲覧の操作」のリンクは、 Enter
を押すと普通に開いてしまい、新しいページに移動するのですが、
ここでは「新しいタブ」で開いてみましょう。
アプリケーションキーを押して「コンテクストメニュー」を開いてください。
Shift+f10 キーもアプリケーションキーの代わりに利用できます。

下矢印を押すと 「リンクを新しいタブで開く」 が最初に出てくるので Enter
を押してください。

リンクを「新しいタブ」で開いたのですが、
現在のウィンドウは何も変化なくそのまま操作できます。

-  NVDA+T：現在のウィンドウのタイトルを報告

「NVDA 日本語版 ダウンロードと説明 Mozilla Firefox」

しかし「タブ」を切り替えると、先ほど開いた 「NVDA日本語版 操作ガイド」
に移動できます。タブを切り替える Firefox の操作を試してください。

-  Ctrl+Tab：次のタブに移動 （Ctrl+Page Down でも同じ）

「NVDA日本語版 操作ガイド ドキュメント」

ドキュメントが丸ごと別の内容に入れ替わりました。

この「タブ」という機能は、ひとつのウインドウに複数のドキュメントを読み込ませて、
画面の上にある押しボタンのような切り替えのしくみで簡単に切り替えられる、
というものです。

いま切り替えた「NVDA 日本語版 操作ガイド」は、ブラウズモードの操作の
練習に使っていただける内容がたくさん含まれています。
ぜひご活用ください。

なお、開くアドレスが最初からわかっている場合は、
ナビゲーションツールバーから「新しいタブで開く」ことができます。 Alt+D
で移動して www.nvda.jp と入力して Alt+Enter を押してください。

3.1.10 Firefox のキーボードショートカット一覧
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Firefox のキーボードショートカット一覧を開く方法を紹介します。 Alt
をポンと1回押して離して、左矢印キーを1回押すと、
ぐるっと回って一番右端の「ヘルプ」のグループに移動するので、
下矢印キーを3回押して「キーボードショートカット」で Enter
を押してください。 新しいタブで「キーボードショートカット」という
Mozilla サポートのドキュメントが開きます。

以上で Firefox の操作の基本の説明は終わりです。

3.2 NVDA で Gmail を使う
~~~~~~~~~~~~~~~~~~~~~~~~

3.2.1 Gmail の概要
^^^^^^^^^^^^^^^^^^

Gmail という電子メールのサービスを紹介します。

`Google <https://www.google.co.jp/>`__ が提供する Gmail
（ジーメール）は無料で使える高機能のメールサービスです。 Web
ブラウザで使用できる Gmail には「標準 HTML 形式」と「簡易 HTML
形式」の2種類のモードがありますが、 2015年ごろから標準 HTML 形式の Gmail
が Firefox と NVDA をサポートするようになりました。

Gmail には以下のような特長があります。

-  受信したメールを約15GBまで無料で保存可能
-  過去のメールの検索機能が充実
-  迷惑メール対策が充実
-  フォルダに振り分ける機能の代わりとして、アーカイブ、スター、ラベルなどでメッセージを整理できる
-  チャット、ハングアウト、カレンダーなど、他のサービスと連携
-  PC
   にインストールされたメールアプリや、スマートフォンのアプリからも利用できる

ここでは Firefox による Gmail の操作を説明します。

晴眼者が使う Web
サービスとまったく同じ画面をスクリーンリーダーで操作できるのは、最新の
Web アクセシビリティの技術の進歩と、 それを取り入れて改良してきた NVDA,
Firefox, Gmail の努力の結果です。

Gmail のような高機能の Web
サービスがスクリーンリーダーに対応しているということが、広く知られることを願っています。

3.2.2 Gmail を使う準備
^^^^^^^^^^^^^^^^^^^^^^

NVDA の設定は以下を想定しています。

-  設定 - キーボード設定

   -  「入力文字の読み上げ」チェック
   -  「入力単語の読み上げ」チェックなし
   -  「スペルの間違いを入力中に音で報告」チェック

-  設定 - ブラウズモード

   -  「サポートされている場合画面レイアウトを使用」チェックなし
   -  「ページ読み込み時に自動的に読み上げる」チェックなし
   -  「フォーカスの変化を追跡する自動フォーカスモード」チェックなし
   -  「フォーカスモードとブラウズモードの切替を音で報告」チェックなし

-  設定 - 書式情報

   -  「スペルの間違いの報告」チェック
   -  「クリック可能の報告」チェックなし

Firefox の設定は以下を想定しています。

-  詳細 - 一般

   -  アクセシビリティ

      -  「ページ中の移動にカーソルを使用する(キャレットブラウズモード)」チェックなし
      -  「キー入力時に検索を開始する」チェックなし

   -  ブラウズ

      -  「自動スペルチェック機能を使用する」チェック

Gmail アカウントの設定は以下を想定しています。 （「キーボード
ショートカット」の設定変更はのちほど説明します）

-  全般

   -  言語：Gmail 表示言語 日本語
   -  スレッド表示 ON チェック
   -  キーボード ショートカット ON チェック
   -  メール本文のプレビューを表示 チェック

-  受信トレイ

   -  カテゴリ

      -  ソーシャル チェックなし
      -  プロモーション チェックなし

-  チャット

   -  チャット OFF チェック

3.2.3 ナビゲーション、ショートカット、文字入力の切替
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

NVDA と Firefox の組み合わせで Gmail
を操作する状況では、以下のようないろいろな目的でキー入力が使われます。

-  Windows の操作（Windows キーなど）
-  Firefox のメニュー操作（Alt キーなど）
-  NVDA の操作（NVDA キーによる設定変更や Shift
   単独による読み上げ一時停止など）
-  1文字ナビゲーション（次のボタンにBで移動、次のコンボボックスにCで移動、など）
-  Gmail のキーボード ショートカット（新規メールの作成はC、など）
-  Gmail のエディットボックスへのテキスト入力

キー入力の目的を切り替えるために NVDA
には「ブラウズモード」と「フォーカスモード」があります。

-  NVDA+スペース：「ブラウズモード」「フォーカスモード」を切り替える
-  Enter：エディットボックスなどで「フォーカスモード」に切り替える
-  Esc：エディットボックスなどで「ブラウズモード」に切り替える

「ブラウズモード」（NVDA 2015.3 以降）には Gmail
の操作に役立つ特別な機能があります。

-  NVDA+Shift+スペース：ブラウズモードで「英字キーを入力に使用」「1文字ナビゲーションを使用」を切り替える

まとめると、以下のようなモードの使い分けができます：

-  フォーカスモード：Gmail
   のキーボードショートカットやテキスト入力が可能
-  ブラウズモード

   -  1文字ナビゲーションを使用：ブラウズモードのすべての操作が可能
   -  英字キーを入力に使用：矢印キーだけブラウズモードの操作、Gmail
      のキーボードショートカットやテキスト入力も可能

以下では「英字キーを入力に使用」はメールアドレスの入力に使います。
「フォーカスモード」は件名やメッセージ本文の入力に使います。
それ以外は「1文字ナビゲーションを使用」で操作します。 Gmail
のキーボードショートカットは有効にしますが、覚えるのが大変なので、いまは使わないことにします。

3.2.4 受信トレイと設定ページ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Firefox で「URLまたは検索語句を入力します エディット」に移動するには
Ctrl+L を押します。

これ以降の説明は `gmail.com <http://gmail.com>`__
を開いて、ログインに成功した状態を想定しています。

現在のページのタイトルを NVDA+T で確認します。
「受信トレイ」で始まる名前であることがわかります。

Firefox のメニューバーと Gmail のページ内容は Alt
キーを押すたびに行ったりきたりできます。

-  「ファイル サブメニュー Alt+F 1の7」
-  「受信トレイ - (あなたのアドレス) - Gmail ドキュメント テーブル
   ・・・」

確認できたら「受信トレイ」にフォーカスを戻します。
ドキュメント以外の場所にフォーカスがある場合は Tab で「Gmail
ドキュメント」に移動します。

次に NVDA+スペース で「ブラウズモード」にします。
「フォーカスモード」の場合は、もう一度 NVDA+スペース を押します。

1文字ナビゲーションのボタン(B)を使って、このページのボタンを把握します。
「次のボタンがありません」と言われたら NVDA+Tab
で現在位置を確認できます。 Shift+B で前のボタンに戻ります。

Gmail では「メニューボタン」も多く使われていますが、同じように B
でジャンプできます。

設定ページに移動して設定を変更してみましょう。

ボタン(B)で「設定 メニューボタン 折りたたみ サブメニュー」に移動します。
スペースを押してこの「設定」ボタンを実行します。

「展開 メニュー サブメニュー 表示間隔・・・」

画面表示では、メニューボタンを実行すると、元のページの上にメニューが開きます。

なお、メニューが開いているときに Esc
を押すと「メニューの外」と読み上げてメニューを閉じ、ボタンに戻ります。

メニューを開いたら下矢印キーを押して、以下の項目を確認します。

-  「表示間隔」
-  「チェックメニュー項目 チェック 標準 (より大きな画面の場合)」
-  「チェックメニュー項目 チェックなし 小 (より大きな画面の場合)」
-  「チェックメニュー項目 チェックなし 最小」
-  「区切り 使用不能」
-  「メニュー項目 受信トレイを設定」
-  「区切り 使用不能」
-  「メニュー項目 設定」
-  「メニュー項目 テーマ」
-  「メニュー項目 ヘルプ」

下矢印キーで「メニュー項目 設定」に戻って Enter を押します。

設定のページに移動したら、読み上げを途中で止めてかまいません。
念のために NVDA+T でウィンドウのタイトルを、NVDA+Tab
でフォーカスを確認します。

-  NVDA+T 「設定 - (あなたのアドレス) - Gmail - Mozilla Firefox」
-  NVDA+Tab 「全般 タブ フォーカス 選択 1の1」

ラジオボタン(R) を使って「キーボード ショートカット」を探します。

-  「キーボード ショートカット OFF ラジオボタン チェック」
-  「キーボード ショートカット ON ラジオボタン チェックなし」

こうなっている場合は ON のラジオボタンを選択します。

「キーボード ショートカット ON ラジオボタン
チェックなし」でスペースを押します。

「チェック」と読み上げれば設定を変更できています。

そして、ランドマーク(D)を使って移動します。

「ナビゲーション ランドマーク ボタン 変更を保存」

さらに下矢印キーを押すともうひとつボタンがあります。

「ボタン キャンセル」

上矢印キーで「変更を保存」に戻ります。

「変更を保存」でスペースを押すと
「使用不能」と読み上げられますが、すこし待つと「受信トレイ」に戻ります。
設定を変更しなかった場合は「キャンセル」を実行します。

なお、「変更を保存」と「キャンセル」のボタンは左右に並んでいるので
「画面レイアウト」だと上下矢印キーで「キャンセル」のボタンに移動できません。
その場合は NVDA+V で「画面レイアウトを使用しない」に切り替えます。

以上で Gmail
の「受信トレイ」と「設定」のページで使われているボタンやメニューを NVDA
で操作できました。

3.2.5 新規メッセージの作成
^^^^^^^^^^^^^^^^^^^^^^^^^^

「受信トレイ」のページからメールを作成して送信します。 手順は以下の (1)
から (5) のとおりです。

(1) 「作成」を実行

B または Shift+B を使って「作成 ボタン」でスペースを押します。

画面は「受信トレイ」のページの上に「新規メッセージ」というダイアログが重なった状態に変化します。

-  （前半の読み上げを省略）
-  「作成 新規メッセージ ダイアログ」
-  「To コンボボックス 折りたたみ 複数行 編集可能 オートコンプリート
   ブランク」

ダイアログの中では Tab と Shift+Tab でフォーカスの移動ができます。
（上下の矢印キーでも可能ですが Tab のほうが効率的です）
なお、このダイアログを閉じて「受信トレイ」に戻りたい場合は Esc
を押します。

(2) 「To」欄に送信先メールアドレスを入力

NVDA+Shift+スペース で「英字キーを入力に使用」にします。

もし「スペース」と読み上げたら NVDA+スペース
で「ブラウズモード」にして、やり直します。

半角全角キーを押して「変換停止」にします。

自分にメールを送ってみるために、自分のメールアドレスを入力します。

途中で「展開」という音声が聞こえても、無視してください。
訂正するときには Backspace と左右の矢印キーを使います。

入力し終わったら NVDA+Shift+スペース
で「1文字ナビゲーションを使用」にします。

Tab を押します。以下のように読み上げます。

「（メールアドレス）さんを追加しました。削除するには Backspace
キーを押してください」

さらに Tab と Shift+Tab を使って

-  「To - 連絡先の選択」
-  「（入力したメールアドレス）」
-  「コンボボックス 折りたたみ オートコンプリート 編集可能 複数行」

のように要素が並んでいることを確認します。

メールアドレスのところで Backspace を押すと削除ができます。
「編集可能」のところには、さらに送信先を追加できます。

ここでは説明しませんが、
連絡先に登録した相手や、過去に受け取ったメールの送信者をオートコンプリートで選ぶこともできます。

(3) 件名を入力

Tab キーを押して「件名 エディット」に移動します。

Enter で「フォーカスモード」にします。

半角全角キーで「変換停止」にします。

ここでちょっと寄り道をするのですが、 hello. (h e l l o ピリオド)
と入力するつもりで「h e l o
ピリオド」と間違えて入力したらどうなるか、試してみます。

最後のピリオドを入力したところで「ジー」というブザーの音が聞こえます。

これは「スペルの間違いを入力中に音で報告」の機能です。

Backspace を2回押して「l o ピリオド」と入力します。

今度はブザーの音が聞こえなくなります。

(4) 本文を入力

Tab キーで「メッセージ本文 エディット」に移動します。

半角全角キーで「文字変換」にします。

ローマ字で「こんにちは。」と入力して、ひらがなのまま Enter
で確定します。

-  k o n n n i t i h a ピリオド Enter

「こんにちは マル」という読み上げを確認します。

(5) 送信を実行

Tab キーを押して「送信 (Ctrl+Enter) ボタン」に移動します。

ここでスペースを押して送信を実行します。

「アラート メッセージを送信しました」と読み上げます。

なお、ボタンの説明にあったように、ダイアログの中では Ctrl+Enter
が送信のショートカットとして使えます。

3.2.6 受信トレイの確認
^^^^^^^^^^^^^^^^^^^^^^

「受信トレイ」ページで受信したメールを確認します。

NVDA+Shift+スペース を押して「1文字ナビゲーションを使用」にします。

テーブル(T) で以下の場所に移動します。

「メイン ランドマーク テーブル 1行8列のテーブル 1行1列」

下矢印キーで1列ずつ移動します。

-  「4列 自分」
-  「6列 リンク hello. こんにちは。」

のように、さきほど自分が送ったメールが表示されます。

メッセージを詳しく確認したい場合や、返信をしたい場合には、
このメールを選択して「スレッド」というページに移動します。

6列の場所で Enter を押します。 （スペースでも実行できます）

「スレッドを開きました。未読メッセージは1件です。テーブルの外 メイン
ランドマーク hello. 見出し レベル2」

「受信トレイ」からスレッドに切り替わりました。

ここでリスト項目(I)を使い、メッセージに移動します。

以下の内容が連続して読み上げられます：

-  「リスト 1項目 (送信者の名前とアドレス) 見出し レベル3 (送信時刻)」
-  「スター付き チェックボックス チェックなし」
-  「返信 ボタン」
-  「その他 メニューボタン 折りたたみ サブメニュー」
-  「To 自分」
-  「詳細を表示 ボタン」
-  「こんにちは。」
-  「クリックして 返信 リンク または 転送」

「こんにちは。」という行で左右の矢印キーを使えば、1文字ずつ文字を確認できます。

なお、「スター付き
チェックなし」は「スター」がついていないという意味です。
スターがついているときには「yellow-star チェックボックス
チェック」のようになります。

3.2.7 メール返信とアーカイブ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

スレッドのページで、読んでいるメールに対する返信のメッセージを書くことができます。

下矢印キーで「リンク 返信 または」に移動して Enter を押します。

-  「メッセージ本文 エディット」
-  「(メールアドレス)さんを追加しました。削除するには Backspace
   キーを押してください。」

返信のテキストを入力するエディットで Enter
を押して「フォーカスモード」にします。

今度は2行で書いてみます。

-  ありがとう。（Enter で改行）
-  よろしく。（Enter で改行）

フォーカスモードでは上下の矢印キーでエディットの1行目と2行目に移動できます。
左右の矢印キーでキャレットを動かして1文字ずつ編集することもできます。

入力が終わったら Esc で「ブラウズモード」にします。

ボタン(B)で「送信(Ctrl+Enter) ボタン」に移動してスペースを押します。

「アラート メッセージを送信しました」

という音声が聞こえます。

NVDA+Shift+スペース で「1文字ナビゲーションを使用」にします。

ページはスレッドのままですが、リスト項目(I)
で確認すると、最初のメールと返信のメールの2件になっています。

このように Gmail
ではページが切り替わらないのにページの一部分が更新されることが頻繁にあります。

2番目の項目の中身を上下の矢印キーで確認します。

「ありがとう。よろしく。」というメッセージの下に「引用」として「こんにちは。」が書かれていることがわかります。

さて、不要になったメールは「アーカイブ」すると「受信トレイ」に表示されなくなります。
こうしておくと、新しいメールをいつでも探しやすくなります。

ボタン(B)で「アーカイブ ボタン」に移動してスペースを押します。

アーカイブが完了すると「受信トレイ」ページに戻っていることが確認できます。

テーブル(T)で確認すると「新着メールはありません」に変わっています。

3.2.8 メールの検索
^^^^^^^^^^^^^^^^^^

アーカイブされたメールは削除されるわけではなく「すべてのメール」という場所に保存されます。
「受信トレイ」ページから「検索」を使ってみます。

エディット(E)で「検索 エディット サブメニュー」に移動します。

Enter を押して「フォーカスモード」にします。

半角全角キーで「変換停止」を確認します。

hello (h e l l o) と入力します。

Esc を押して「ブラウズモード」にします。

ボタン(B) を2回押して「Gmail を検索
ボタン」に移動してスペースを押します。

実行すると「検索結果」というページの「テーブル」に移動しています。 Gmail
では複数のメールによるやりとりを「スレッド」という単位で管理しており、
受信トレイや検索結果のテーブルでは1行が1つのスレッドに対応します。

受信トレイと同じように項目に移動して Enter
でスレッドのページに移動できます。

検索結果のページからは以下の操作で受信トレイに戻ります。

-  Shift+D で「ラベル ナビゲーション ランドマーク」に移動
-  上下の矢印キーで「既読 リンク 受信トレイ」に移動
-  Enter で実行

以上で Gmail の基本的な操作を紹介しました。
マスターできたら、自分以外のメールアドレスに送信してみましょう。

なお「スペルの間違いを入力中に音で報告」は NVDA 2016.2
で追加された機能です。
現在は日本語には対応していませんが、便利さを理解していただけたと思います。

3.2.A (資料) 1文字ナビゲーションのまとめ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

`ユーザーガイド 6.1.
1文字ナビゲーション <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#SingleLetterNavigation>`__
から、Gmail で便利な操作を引用します。

-  K リンク
-  N リンクのないテキスト
-  H 見出し
-  D ランドマーク
-  E エディットフィールド
-  B ボタン
-  T テーブル
-  I リスト項目

3.2.B (資料) Gmail サポート情報
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Gmail アカウントの作成：

Gmail を使うには Google アカウントが必要です。
お持ちでない場合はまずアカウントを作成してください。
メールを受け取ることができる既存のアドレスや生年月日などの個人情報が必要です。
必須ではありませんがスマートフォンの電話番号などの入力も求められます。

携帯メールのアドレスまたは音声通話を受けられる電話番号を入力して、6桁の確認番号を受け取って、それを画面に入力する、といった本人確認（端末確認）が必要になる場合もあります。

-  `Gmail
   アドレスの作成 <https://support.google.com/mail/answer/56256?hl=ja>`__

その他の Gmail サポートのリンク：

-  `標準 HTML 形式と簡易 HTML
   形式 <https://support.google.com/mail/answer/15049?hl=ja>`__
-  `スクリーン リーダーでの Gmail
   標準形式の使用 <https://support.google.com/mail/answer/90559?hl=ja>`__
-  `Gmail のキーボード
   ショートカット <https://support.google.com/mail/answer/6594?hl=ja>`__

3.2.C (資料) Gmail ページの構造
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Gmail のページに含まれる要素を独自に調査した情報です。 この内容は Gmail
のアカウントごとの設定によって異なる場合があります。 また、将来 Gmail
の仕様が変更される場合があります。

B や K
などのアルファベットは、1文字ナビゲーションの対象であることを示します。
例えば H2 は 見出しレベル2 なので、1文字ナビゲーションの H または 2
で移動できます。

「受信トレイ」ページに含まれる要素：

-  B 簡易HTML形式（表示なし）

-  K コンテンツへ（表示なし）

-  K Gmailでのスクリーンリーダーの使用（表示なし）

-  D バナー

   -  Googleバー

      -  K Googleアプリ 折りたたみ
      -  K Googleのお知らせ 折りたたみ
      -  K Googleアカウント（メールアドレス）折りたたみ

   -  Gmailアクションバー

      -  K Gmail（ロゴ画像）
      -  D 検索 H2
      -  E 検索 サブメニュー
      -  B 詳細検索オプション
      -  B Gmailを検索

-  アラート（一時的に表示される）

   -  xxがxxされました
   -  K 詳細
   -  K 取消

-  B 移動先 メニューボタン サブメニュー

-  B 作成

-  D ラベル ナビゲーション H2

   -  K 受信トレイ
   -  K スターつき
   -  K 送信済みメール
   -  K 下書き
   -  B 開く

-  B メニューボタン サブメニュー 選択（すべてのスレッドを選択）

-  B 更新（スレッド未選択の場合に表示）

-  B アーカイブ（スレッドを選択すると表示）

-  B 迷惑メールを報告（スレッドを選択すると表示）

-  B 削除（スレッドを選択すると表示）

-  B 移動（スレッドを選択すると表示）

-  B ラベル（スレッドを選択すると表示）

-  B その他

-  B xx-xx / xx
   ボタン（表示されているメッセージの数／すべてのメッセージの数）

-  B 前

-  B 次

-  B 設定

-  D メイン スレッド H2

   -  T xx行8列のテーブル（Ctrl+Alt+矢印キーで移動）

      -  1列 ブランク
      -  2列 チェックボックス
      -  3列 画像
         スターなし（スターの場合も「スターなし」と読みあげる？）
      -  4列 送信者
      -  5列 ブランク
      -  6列 題名と本文
      -  7列 ブランク
      -  8列 日付と時刻

-  フッター

   -  xxGB (xx%) / xxGB を使用中
   -  K 管理
   -  K 利用規約
   -  K プライバシー
   -  前回のアカウント アクティビティ xx 分前
   -  K アカウント アクティビティの詳細

スレッドのページに含まれる要素：

-  K コンテンツへ（表示なし）

-  K Gmailでのスクリーンリーダーの使用 展開（表示なし）

-  K キーボードショートカット（表示なし）

-  K Gmail（標準HTML形式）ガイド（表示なし）

-  D バナー

   -  Googleバー

      -  K Googleアプリ 折りたたみ
      -  K Googleのお知らせ 折りたたみ
      -  K Googleアカウント（アカウント名）折りたたみ

   -  Gmailアクションバー

      -  K Gmail（ロゴ画像）
      -  D 検索 H2
      -  E 検索 サブメニュー
      -  B 詳細検索オプション
      -  B Gmailを検索
      -  B ナビゲート

-  アラート（一時的に表示される）

   -  xxがxxされました
   -  K 詳細
   -  K 取消

-  B 移動先 折りたたみ

-  B 作成

-  D ラベル ナビゲーション H2

   -  K 受信トレイ
   -  K スターつき
   -  K 送信済みメール
   -  K 下書き
   -  B 開く

-  D 補足情報 ハングアウト H2

   -  B チャット設定
   -  B チャット相手を検索

-  B 受信トレイに戻る（または現在のラベルの名前）

-  B アーカイブ

-  B 迷惑メールを報告

-  B 削除

-  B 移動 折りたたみ（ラベルによって異なる）

-  B ラベル 折りたたみ

-  B その他 折りたたみ

-  B 前

-  B 次

-  B 設定 折りたたみ

-  D メイン

   -  B すべて展開
   -  B すべて印刷
   -  B 新しいウィンドウで開く
   -  H2 （スレッドの題名）
   -  B ラベル名（同じラベルがついたメッセージを検索）
   -  B エックス（スレッドからこのラベルを削除）
   -  I （送信者の名前とアドレス リスト項目） H3

      -  B 返信
      -  B その他 メニューボタン 折りたたみ サブメニュー
      -  B 詳細を表示
      -  N メッセージの内容

         -  K メッセージに含まれるリンク

      -  K 添付ファイル エリア

         -  B 添付ファイル xx をダウンロード
         -  B ドライブへ添付ファイル xx を保存

      -  B 短縮されたコンテンツを表示する

   -  I （送信者の名前とアドレス リスト項目） H3
   -  K 返信
   -  K 転送

-  フッター

   -  xxGB (xx%) / xxGB を使用中
   -  K 管理
   -  K 利用規約
   -  K プライバシー
   -  K アカウント アクティビティの詳細

-  D 補足情報 xxさんのプロフィール写真

   -  B Google+に参加
   -  B xxさんとハングアウト
   -  B xxさんとのビデオ ハングアウトを開始
   -  B xxさんにメールを送信
   -  B その他の操作 折りたたみ
   -  K 詳細を表示

4 オブジェクトナビゲーション
----------------------------

4.1 アクティブウィンドウの読み上げ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Windows を直接操作しないで画面に表示されている情報を読み取る機能として、
NVDA には
レビューカーソル、あるいはオブジェクトナビゲーションとよばれるものがあります。

視力のある人がこの内容を学習したり、学習者のサポートをするときには、
「アドオンの活用」の章で紹介している「フォーカスハイライト」アドオンを
入れておくことをお勧めします。

NVDA で使われる「オブジェクト」という言葉は Windows が画面表示に使う
「要素」や「部品」のことです。
慣れるまではユーザーガイドの「オブジェクトナビゲーション」と
「レビューカーソル」という言葉は同じことだと考えてください。
どう違うかは後ほど説明します。

ここでは Windows
の「ファイル名を指定して実行」ダイアログを取り上げます。

Windows+R を押すと以下のように報告されます：

「ファイル名を指定して実行 ダイアログ …」

なお、引用する例は以下の設定を想定しています：

-  音声設定「記号」「読まない」
-  オブジェクト表示設定「オブジェクトのショートカットキーの報告」「チェックなし」

NVDA には「アクティブウィンドウの読み上げ」という機能があります。
実はこの機能を使うと「レビューカーソル」は勝手に動いてしまうのです。

-  NVDA+B：アクティブウィンドウの読み上げ

押すと下記のように読み上げます。 （notepad
と読み上げている箇所は直前に入力したファイル名によって異なります）

「 ファイル名を指定して実行 ダイアログ
実行するプログラム名、または開くフォルダーやドキュメント名、インターネット
リソース名を入力してください。 画像
実行するプログラム名、または開くフォルダーやドキュメント名、インターネット
リソース名を入力してください。 名前(O): 名前(O): コンボボックス notepad
折りたたみ エディット notepad 選択 OK ボタン キャンセル ボタン 参照(B)…
ボタン 」

いくつか読み上げ操作を復習しましょう。

-  NVDA+T：ウィンドウのタイトルの読み上げ

押すと 「ファイル名を指定して実行」

-  NVDA+Tab：フォーカスの読み上げ

押すと 「エディット　フォーカス　notepad 選択」

これらはウィンドウが開いた直後に読み上げた情報と同じです。

「フォーカス」とは Windows におけるキーボード入力や操作の対象です。
文字を入力できる状態ではキャレット（文字入力カーソル）があります。
マウスを動かして移動させることができるマウスカーソル（マウスポインタ）もあります。

NVDA
の「レビューカーソル」は、これらとは独立して動かせる「読み取り専用カーソル」なのです。

いまレビューカーソルはどこにあるのでしょう？

ラップトップ配列：

-  NVDA+Shift+O：レビューカーソルの要素（ナビゲーターオブジェクト）の確認

デスクトップ配列：

-  NVDA+テンキー5：レビューカーソルの要素（ナビゲーターオブジェクト）の確認

この操作をすると

「参照(B)… ボタン」

と報告されます。

もういちど説明すると、いまフォーカスは「エディット」にあり、
レビューカーソルは「ボタン」にあるのです。

どうですか？ 「レビューカーソル」を意識できましたか？

うっかり他のキー操作をするとフォーカスのある要素を操作してしまうので、
気をつけてください。

レビューカーソルが画面のどこかで四角形の場所を指しているときに、
その場所や大きさを知る方法もあります。

ラップトップ配列：

-  NVDA+Delete：レビューカーソルの要素の位置を報告

デスクトップ配列：

-  NVDA+テンキーDelete：レビューカーソルの要素の位置を報告

押すと例えば以下のように報告されます：

「オブジェクトは、画面左端から16.4パーセント、上端から91.2パーセントにあり、画面の幅の4.6パーセント、高さの2.4パーセントを占めています」

さて、わかりきったことかも知れませんが、レビューカーソルの要素に何が書かれているか、
確認しましょう。

ラップトップ配列：

-  NVDA+Shift+ピリオド：レビューの現在行の報告

デスクトップ配列：

-  テンキー8：レビューの現在行の報告

押すと 「参照(B)…」

すばやく2回押すと
「マイリ　アキラ　カッコ　ビー　カッコトジ　ピリオド　ピリオド　ピリオド」

すばやく3回押すと
「参考書のサン　照らすのショウ　半角カッコ　半角英字大文字ビー　半角カッコトジ　半角ピリオド　半角ピリオド　半角ピリオド」

レビューカーソルはいままで四角形だと説明してきたのですが、
それは「ボタン」の話です。
レビューカーソルは「ボタン」の中の文字を一つ一つ確認できるのです。

ラップトップ配列：

-  NVDA+ピリオド：レビューの現在の文字の報告

デスクトップ配列：

-  テンキー2：レビューの現在の文字の報告

1回または2回押すと： 「参考書のサン」

3回押すと： 「21442 u 53c2」

3回押すと文字コードを10進数と16進数で説明します。
テキスト（文字）の確認でご紹介した「文字単位の移動」で
ボタンの中を1文字ずつ左右に移動しながら確認できます。

ラップトップ配列：

-  NVDA+左矢印：前の文字に移動
-  NVDA+右矢印：次の文字に移動

デスクトップ配列：

-  テンキー1：前の文字に移動
-  テンキー3：次の文字に移動

最初は「ナビゲーターオブジェクトとレビューカーソルは同じ」と説明をしましたが、
ここではちょっと違います。
ナビゲーターオブジェクトは「参照」というボタンを指しています。
レビューカーソルはその中の文字を指しています。

4.2 ナビゲーターオブジェクトの移動
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

いよいよナビゲーターオブジェクトを動かしてみましょう。
このボタンのまわりには何があるのでしょう？

画面を構成する要素は

-  「親要素の下の階層に子要素がある」
-  「お兄さん要素と同じ階層に弟要素がある」

といった二次元の関係になっています。

「要素の位置の報告」機能で確認した画面の上下左右と区別するために、
ここでは「親子」「兄弟」という言葉で説明します。

家系図のようなものをイメージしてください。

この家系図では、親要素と子要素は上下に並びます。
また兄弟要素は左右に並びます。左側をお兄さんと呼びます。
この上下と左右がキー操作に対応しています。

レビューカーソルを要素単位で移動しましょう。

ラップトップ配列：

-  NVDA+Shift+右矢印：次の要素に移動

デスクトップ配列：

-  NVDA+テンキー6：次の要素に移動

押すと 「次のオブジェクトなし」

「参照(B)…」の右に兄弟要素がない、つまり「参照(B)…」が一番末っ子です。

ラップトップ配列：

-  NVDA+Shift+左矢印：前の要素に移動

デスクトップ配列：

-  NVDA+テンキー4：前の要素に移動

押すと順番に

-  キャンセル ボタン
-  OK ボタン
-  名前(O): コンボボックス notepad 折りたたみ
-  名前(O):
-  実行するプログラム名、または開くフォルダーやドキュメント名、インターネット
   リソース名を入力してください。
-  画像
-  前のオブジェクトなし

この「前のオブジェクトなし」がこの階層の左端を示します。
画像は長男、コンボボックスやボタンがその下の兄弟です。

それでは

「名前(O): コンボボックス notepad 折りたたみ」

というオブジェクトにいったん戻ってください。

さて、今度は親子関係を見ていきましょう。

以下を操作してください。

ラップトップ配列：

-  NVDA+Shift+下矢印：子要素に移動

デスクトップ配列：

-  NVDA+テンキー2：子要素に移動

以下が報告されます：

-  エディット notepad 選択

現在の要素を確認し直します：

ラップトップ配列：

-  NVDA+Shift+O：レビューカーソルの要素を確認

デスクトップ配列：

-  NVDA+テンキー5：レビューカーソルの要素を確認

押すと

-  「エディット　フォーカス　notepad　選択」

この状態で「前の要素に移動」「次の要素に移動」を使えば、
「エディット　フォーカス　notepad　選択」には他に兄弟の要素がいないことがわかります。

親要素に戻るのは上方向です。家系図をイメージしてください。

ラップトップ配列：

-  NVDA+Shift+上矢印：親要素に移動

デスクトップ配列：

-  NVDA+テンキー8：親要素に移動

押すと

-  名前(O): コンボボックス notepad 折りたたみ

さらに親要素はあるのでしょうか？ もう一度「親要素に移動」を押すと

-  「ファイル名を指定して実行　ダイアログ」

このダイアログはエディットやボタンなどの兄弟すべての親要素です。
このダイアログに兄弟要素はあるでしょうか？

「次の要素に移動」では何も見つかりません。

「前の要素に移動」を押していくと以下を確認できます：

-  閉じる ボタン ウィンドウを閉じます。
-  システム メニューバー ウィンドウを操作するコマンドが含まれています。

詳しい操作は省略しますが、「システム
サブメニュー」の子要素に「システム　サブメニュー」があります。
これはダイアログを開いてすぐに Alt
キーを押すと出てくるメニューと同じものです。
（このメニューの中には「移動」と「閉じる」のメニュー項目があります）

最初に見つかった「閉じる
ボタン」は標準的なウィンドウの右上にある赤いバツ印のついたボタンです。

4.3 レビューカーソルの位置のボタンを押す
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ナビゲーターオブジェクトがボタンにあるときに、そのボタンを押すための操作を二通り説明します。

これらは Tab キーで移動できないボタンを押すときに役立ちます。

4.3.1 マウスクリックでボタンを押す
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

マウスクリックでボタンを押すためは
「マウスカーソルを移動する」「左クリックを実行する」の2段階が必要です。

ラップトップ配列：

-  NVDA+Shift+M：マウスカーソルを移動

デスクトップ配列：

-  NVDA+テンキースラッシュ：マウスカーソルを移動

押すと「閉じる」と読み上げます。
ナビゲーターオブジェクトとレビューカーソルの位置にマウスカーソルが移動して、
マウスカーソル位置のオブジェクトが報告されたからです。

続けて、以下を操作します。

ラップトップ配列：

-  NVDA+開き角括弧：左クリック

デスクトップ配列：

-  テンキースラッシュ：左クリック

押すとウィンドウが閉じて、その下のウィンドウやデスクトップなどにフォーカスが移ります。

なお、左クリックの操作を素早く2回繰り返すとダブルクリックができます。
右マウスボタンを押したり、マウスボタンを押し続けた状態（ロック）にすることもできます。
これらのテクニックは、マウスでの操作しか考慮されていないアプリで有用でしょう。

詳しくはユーザーガイドを参照してください。

-  `ユーザーガイド 5.7.
   マウスカーソルの移動 <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#NavigatingWithTheMouse>`__

4.3.2 既定のアクションの実行
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

このアプリがアクセシビリティに配慮して作られている場合、
具体的には「既定のアクション」をこのボタンに割り当てている場合には、
もっと簡単にボタンを押すことができます。

もう一度「ファイル名を指定して実行」ダイアログを開いてください。
今度は最初からレビューの操作で「閉じる ボタン」に移動しましょう。

ラップトップ配列：

-  NVDA+Shift+上矢印：親要素に移動
-  NVDA+Shift+左矢印：前の要素に移動

デスクトップ配列：

-  NVDA+テンキー8：親要素に移動
-  NVDA+テンキー4：前の要素に移動

押すと「閉じる　ボタン」

フォーカスのあるボタンはスペースで押せますが、
レビューカーソルからはボタンを次の方法で押します。

ラップトップ配列：

-  NVDA+Enter：レビューカーソル位置の要素で既定のアクションを実行

デスクトップ配列：

-  NVDA+テンキーEnter：レビューカーソル位置の要素で既定のアクションを実行

この「実行」という操作には「押す」「呼び出し」「アクションの実行」などの別名があります。
ボタンは押されたら何を実行するかが決まっていて、
その割り当てられた処理がこの操作で実行できます。

4.4 オブジェクトの親子関係
~~~~~~~~~~~~~~~~~~~~~~~~~~

「閉じる　ボタン」のもうひとつ上の階層は「ファイル名を指定して実行　ウィンドウ」です。
ダイアログを一般化したものがウィンドウだと理解してください。
その兄弟オブジェクトは、実は Windows デスクトップに
置かれているさまざまな部品やウィンドウです。
起動中のどのアプリのウィンドウにでも、またタスクバーやタスクトレイにも、
このレビューカーソルの移動でたどり着けるのです。
ぜひ、いろいろなウィンドウやアプリでレビューカーソルを試してみてください。

要素（オブジェクト）の親子関係について補足すると、
これはソフトウェアの開発者の都合で決まっています。

例えば親要素の色や位置情報を子要素が受け継ぐ、といった性質があるのです。

画面を見るだけのユーザーには親子・兄弟関係は正確にはわからないので、
要素の順序やつながりがきちんと配慮されておらず、
レビューカーソルでうまく移動できない、不必要に階層が複雑、
といったアプリは残念ながらたくさんあります。

あきらめないでチャレンジしてみてください。

4.5 レビューカーソルに関する設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

NVDAメニュー 設定「レビューカーソル」の項目を簡単に紹介します。

-  `ユーザーガイド 11.1.10.
   レビューカーソル <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#ReviewCursorSettings>`__

以下の設定は、Windows
のフォーカス、文字カーソル、マウスカーソルが移動したときに
レビューカーソルを移動させるかどうかを指定します。

-  「システムフォーカス（フォーカス）を追跡」（キー操作はNVDA+7）
-  「システムキャレット（文字カーソル）を追跡」（キー操作はNVDA+6）
-  「マウスカーソルを追跡」

普段はレビューカーソルはWindowsのフォーカスと一体化しています。
レビューカーソルを動かすとフォーカスとレビューカーソルは分離しますが、
Tabキーでフォーカスを動かすと、レビューカーソルはまたフォーカスにくっついてしまいます。
しかし NVDA+7 を押して追跡を無効にしておけば、
フォーカスを動かしてもレビューカーソルは動かず、分離されたままになります。

4.6 レビューモードの説明
~~~~~~~~~~~~~~~~~~~~~~~~

NVDA のレビュー操作には以下の3種類のモードがあります。

-  オブジェクト（要素）レビュー
-  ドキュメント（文書）レビュー
-  画面レビュー

切り替え操作は次のとおりです。

ラップトップ配列：

-  NVDA+PageUp：次のレビューモード
-  NVDA+PageDown：前のレビューモード

デスクトップ配列：

-  NVDA+テンキー7：次のレビューモード
-  NVDA+テンキー1：前のレビューモード

ウェブブラウザのようなアプリケーション（ブラウズモード）では
意識しなくても自動的にドキュメントレビューに切り替わります。

画面レビューでは要素（オブジェクト）内の行単位の移動が、
画面の改行位置で区切られます。
例えばNVDAメニューのヘルプ「NVDAについて」ダイアログで
「次のレビュー要素に移動」を2回押して見つかる、
テキストのたくさん書かれた要素を下記の操作で読み進めてみてください。

ラップトップ配列：

-  NVDA+下矢印：レビュー内の次の行に移動

デスクトップ配列：

-  テンキー9：レビュー内の次の行に移動

画面レビューに切り替えてこの操作を行うと以下のように区切られます。

-  「NVDAはGNU 一般公衆利用許諾契約書(Version 2)によって保護されていま」

-  「す。この内容に同意いただき、必要としている方にソースコードを提供していただける」

これは画面でこのように改行されて表示されているからです。

なお、マウスカーソルの移動は、画面レビューでは正しく動かないのでご注意ください。

5 Windows の操作と設定の基本
----------------------------

5.1 Windows キー
~~~~~~~~~~~~~~~~

この章では Windows 10 バージョン 1703 に基づいて Windows
の操作と設定の基本を紹介します。

マイクロソフトのサイトには Windows
のキーボードショートカットキーの一覧や
視覚障碍者向け簡易マニュアルがあります：

-  `マイクロソフト製品のアクセシビリティ機能 <http://www.microsoft.com/ja-jp/enable/products/default.aspx>`__
-  `音声とキーボード操作による Windows 10
   基本操作ガイド <https://www.microsoft.com/ja-jp/enable/products/win10v.aspx>`__

まず Windows キーの機能を整理します。

Windows キーを押すと「スタートウィンドウ」が開きます。
スタートウィンドウを閉じるには、もう一度 Windows キーを押すか、Esc
キーを押します。

また、Windows
キーと他のキーを同時に押すと、以下のような機能が利用できます：

-  Windows+D デスクトップにフォーカスを移動
-  Windows+B 通知領域にフォーカスを移動
-  Windows+T タスクバーにフォーカスを移動
-  Windows+X
   コンテクストメニューを表示（「シャットダウンまたはサインアウト」への近道）
-  Windows+A アクションセンターを表示
-  Windows+E エクスプローラーを起動
-  Windows+U 簡単操作を起動
-  Windows+R 「ファイル名を指定して実行」を起動
-  Windows+I 設定を起動
-  Windows+S スタートウィンドウの検索（Cortana）を開く

複数の入力メソッド（日本語入力システムなど）を使っている場合は、以下の操作で切り替えることができます。

-  Windows+スペース：入力メソッドの切り替え

入力方法エディター、入力メソッド、単に「キーボード」と呼ばれることもあります。

アプリを切り替える操作をまとめます：

-  Alt+Tab：Alt を押し続けている間、Tab でアプリケーションの切り替え
-  Windows+Tab：実行中のアプリケーション。左右矢印キーと Enter
   で切り替えて閉じる
-  Alt+F4：現在のアプリを終了

Windows 10
では複数のデスクトップ画面を使えます（仮想デスクトップ）が、ここでは省略します。

5.2 メニューとリスト
~~~~~~~~~~~~~~~~~~~~

Windows+X
で開くコンテクストメニューを例に、メニューの操作方法を確認します。

-  上下矢印キー：メニューの項目の移動
-  Enter：選択中のメニュー項目の実行
-  Escape：メニューを閉じる

メニューは開いた直後の状態では最初のメニュー項目にフォーカスが移動していないことがあります。
その場合は、最初に下矢印キーで先頭の項目に移動します。
また、一番上または一番下で、さらに上や下に移動しようとすると、反対側の端に移動できる場合が多いです。

メニュー項目にはサブメニューという項目が含まれる場合があります。

-  右矢印キー：サブメニューの中に（子の項目に）入る
-  左矢印キー：サブメニューから（親の項目に）戻る

メニュー項目には「アクセラレーターキー」が割り当てられている場合があります。
例えば Windows
のコンテクストメニューには「シャットダウンまたはサインアウト(U)」という項目があり、その中にはさらに「シャットダウン(U)」という項目があります。
この場合、次の操作でシャットダウンを実行できます。

-  Windows+X U U

次に Windows+I で開く「設定」から Tab
を1回押して、リストの操作方法を確認します。

リストにも複数のリスト項目が含まれています。
メニューと同じように矢印キーで移動できますが、すべての項目に移動したい場合に、左右の矢印キーを使った方がよい場合があります。
また、リスト項目は Enter に加えてスペースでも実行できる場合があります。

Windows 10
の「設定」はウィンドウの幅が狭いときには上下方向に並びますが、ウィンドウの幅が広い場合には横方向に並びます。
ウィンドウの幅によって画面の構成や配置が変化するアプリが、これから増えてくると思われます。

5.3 ダイアログボックスとボタン
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Windows+R で「ファイル名を指定して実行」を開いてください。

フォーカスは Tab キーで順番に次の項目に移動できます。
この順番はふつうは画面の上から下、左から右に決められています。 Tab
キーで行き過ぎたときには Shift+Tab キーで逆方向に移動できます。
逆方向移動は先頭の項目から一番最後の項目に移動するときにも便利です。

NVDA+Tabキーで、現在のフォーカス位置の項目の読み上げを行います。
読み上げの中止は Ctrl キーで、中断は Shift キーでできます。
中断したあとでShiftキーをもう一度押すと、続きを読み上げます。

一般的なダイアログボックスは、Enterキーを押すと変更を保存して閉じる、
Escキーを押すと変更をキャンセルして閉じる、という操作になっています。

例えば「OK」と「キャンセル」のボタンがあるときに、 ダイアログの操作を
Enter や Esc で行うのではなく、 確実にどちらかのボタンを押したければ、
ボタンにフォーカスを移動して、スペースを押してください。

ダイアログに表示される情報には、フォーカスの移動だけでは読み上げられないものがあります。
必要に応じて「アクティブウィンドウの読み上げ」「ナビゲーターオブジェクトの移動」を実行する必要があります。

Windows 10
の「設定」には、ボタンに似た役割の「リンク」という要素があります。
何かを実行したり、別の作業を行う画面に移動するために使われます。

リンクはボタンのように四角い枠で囲まれていないテキストです。
文字の色や配置だけで「クリックできる」ことを表現しています。 リンクは
Enter またはスペースでアクションを実行できます。

例えば「設定」「システム」「通知とアクション」の中に「クイックアクションの追加または削除」というリンクがあり、
このリンクを実行すると、いろいろなボタンの表示または非表示を切り替える画面に移動します。

5.4 コンボボックス
~~~~~~~~~~~~~~~~~~

「ファイル名を指定して実行」ダイアログには「コンボボックス
折りたたみ」があります。

コンボボックスには折り畳まれた（クローズの）状態と展開された（オープンの）状態があります。
キーボードではコンボボックスが折り畳まれた状態のまま矢印キーで操作できます。
上下矢印キーを押しても何も読み上げないときは、これ以上選択肢がないことを意味します。

また、コンボボックスは Alt+下矢印
で展開の状態に切り替えることもできます。
展開すると、上矢印キーと下矢印キーで項目の選択、Enter で決定、Esc
でキャンセルです。

Windows 10 のコンボボックスも試してみましょう。

Windows+I で「設定」を開き Tab と右矢印キーを押して「時刻と言語」で
Enter を押します。

次の画面で Tab を押して「リスト　日付と時刻」を見つけたら、
下矢印キーで「音声認識」に移動して Enter を押します。

さらに Tab を押して「音声 Microsoft Ichiro Mobile
折りたたみ」のような名前の要素に移動します。

上下の矢印キーで「Microsoft Ayumi Mobile」「Microsoft Haruka
Mobile」などに切り替えてみてください。

また Alt+下矢印 で展開してから上下矢印で移動、Enter
で項目を選べることも確認してください。

5.5 チェックボックスとトグルボタン
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

チェックボックスはオンとオフの2つの状態を持つコントロールです。 NVDA
ではそれぞれの状態を「チェック」「チェックなし」と読み上げます。
切り替えるには、そこにフォーカスを移動して、スペースを押します。

さきほどの「音声認識」の設定画面には

「この言語のネイティブでないアクセントを認識する」

というチェックボックスがあります。

Windows 10
にはトグルボタンと呼ばれる、似た役割のコントロールがあります。 NVDA
ではトグルボタンの状態を「押されています」「押されていません」と読み上げます。
切り替えるには、チェックボックスと同じく、スペースを押します。

例えば先ほど紹介した「クイックアクションの追加または削除」ウィンドウでトグルボタンが使われています。
このウィンドウには「ホーム」ボタンがありますが、設定の変更を保存するボタンがなく、
変更はすぐに有効になります。

5.6 スライダー
~~~~~~~~~~~~~~

スライダーは NVDA の音声設定にも使われていますが、
数値を視覚的に表現して、値を変更できるようになっています。
キーボードでは上下または左右の矢印キーで値を増やしたり減らしたりできます。
EndキーとHomeキーで最小値や最大値に変えることもできます。
キーを押すたびに数値を読み上げます。

Page Up, Page Downキーによる値の変更は Windows 10
アプリでは使用できないようです。

さきほどの「音声認識」の設定画面には「スピード」というスライダーがあります。

さきほどの音声のコンボボックスとスピードのスライダーの値を変更して、その下にある「音声のプレビュー」ボタンに移動、
スペースを押すと、押した結果を確認することができます。

この画面の設定は NVDA ではなく Windows 10 の音声の設定です。
今後はこの設定に対応したアプリが増えていくと思われます。

5.7 スタートウィンドウと検索
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ここでは Windows 10
（デスクトップモード）のスタートウィンドウを紹介します。

Windows キーを押すとスタートウィンドウが表示されます。

Tab キーを押すごとに以下の要素に移動します。

-  検索ボックス　エディット
-  スタート　ナビゲーション　メニュー項目の切り替え
-  すべてのアプリ　リスト
-  ピン留めしたタイル　リスト

「検索ボックス」にはテキストを入力してアプリを起動することができます。

例えば n o
と入力すると（他に似た名前のアプリがインストールされていなければ）

-  メモ帳　デスクトップアプリ　1の11

などのように報告され、その状態で Enter を押すとメモ帳が起動します。
これは notepad
という（メモ帳の実行ファイルの名前の）先頭の2文字に一致するアプリとして、候補が表示されたからです。

「スタート　ナビゲーション」からは上下の矢印キーで以下の項目を選ぶことができます。

-  ユーザー アカウント
-  場所 リスト　エクスプローラー 1の2
-  設定 2の2
-  電源

ユーザーアカウントは Enter
またはスペースでさらにメニューが開き、その中には「アカウント設定の変更」「ロック」「サインアウト」などの項目があります。

場所（エクスプローラー）はいわゆる Windows
エクスプローラーを起動します。

設定は「設定」というウィンドウを開きます。後ほど説明します。

電源も Enter
またはスペースでさらにメニューが開き、その中には「スリープ」「休止状態」「シャットダウン」「再起動」などの項目があります。

「すべてのアプリ　リスト」は、「最近追加されたもの」「よく使うアプリ」さらに、プログラムやフォルダの名前のアルファベット順にグループ化されて項目が並んでいます。

例えば NVDA がインストールされていると N のグループに NVDA
というフォルダが作られます。

「すべてのアプリ　リスト」が開いている状態で N を押すと N
のグループの先頭の項目にジャンプします。下矢印と上矢印で NVDA
というフォルダーを見つけることができます。

「NVDA フォルダー　折りたたみ済み」

に移動したら、Enter を押してみます。

「NVDA フォルダーの内容 グループ
展開」に続いて「NVDA」と読み上げれば、フォルダーを開いて最初の要素に移動できています。

「折りたたみ済み」または「展開済み」の項目で Enter
を押して状態を切り替えることができます。

ツリービューではないので、左右の矢印キーで折りたたんだり展開したりできません。

「ピン留めしたアプリ」は、ユーザーが自由にアプリを追加したり並べ替えたりできる場所です。

ここに表示されるのは単なるアイコンではなくタイルというすこし大きめの要素であり、アプリが起動されていなくてもこのタイルの中に情報が表示される場合もあります。

例えば Windows
標準の「天気」というアプリは、あらかじめ地域などが設定されていれば、このタイルにフォーカスを移動するだけで、天気を読み上げます。

最初に紹介した検索ボックスには Cortana という対話機能が備わっています。

-  Windows+S 検索のエディットボックス
-  Windows+C Cortanaに音声入力を開始

音声入力の返事は Windows の音声合成で返ってきます。

Cortana
は「何か歌って」「冗談を聞かせて」みたいなお願いも聞いてくれるようです。
NVDA の読み上げ音声と重なって聞き取りづらいので、Windows+C を押す直前に
NVDA+S
で読み上げモードを「読み上げなし」または「ビープ音」にしておくとよいでしょう。

5.8 エクスプローラー
~~~~~~~~~~~~~~~~~~~~

Windows 10 のエクスプローラーは F6
キーを押すたびに以下のグループに移動できます。

-  上へバンド ツールバー
-  ツリービュー（「クイックアクセス」「デスクトップ」などがあります）
-  項目ビュー
-  名前 スプリットボタン（項目ビューのレイアウトが「詳細」の場合）
-  表示モード

キー操作：

-  Ctrl+L：アドレスのエディットに移動（ c: など場所を直接入力できます）
-  Alt：メニューバー（リボン）に移動
-  Ctrl+F1：リボンの展開・折りたたみの切り替え

項目ビューで使えるキー操作：

-  Ctrl+Shift+6：表示モードを「詳細」に切り替える

リボンで使えるキー操作：

-  Tab および矢印キー：移動
-  Ctrl+左右矢印キー：前後のツールバーに移動

リボンの内容はいくつかのグループに分かれていて、各グループは「ツールバー」と読み上げられます。

項目ビューで Alt
キーを押すと、リボンの状態によって以下のように移動先が異なります。

-  リボンが展開済み：Alt を押すと「ホーム」（左端の項目）に移動
-  リボンが折りたたみ済み：Alt
   を押すと「ファイル」「コンピューター」など（左から2番目の項目）に移動

リボンを操作するときには、以下のように NVDA
の「オブジェクト表示」を設定するとよいでしょう。

-  オブジェクトのショートカットキーの報告：チェック
-  オブジェクトの説明の報告：チェックなし

例えば、ファイル名の拡張子の表示は、以下のチェックボックスで切り替えできます。

-  「表示」タブ → 「表示／非表示」ツールバー →
   「ファイル名拡張子」チェックボックス

5.9 Windows の操作と設定のまとめ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

2017年以降 Windows 10
は6か月ごとに大型アップデートが行われると発表されています。

過去の Windows
ではコントロールパネルにあった機能は新しい「設定」アプリにすこしずつ移されています。

Windows 10 の設定は、まず設定アプリで必要なものを探します。
「設定」に設けられたリンクから「コントロールパネル」の設定画面が呼び出されることもありますが、
だんだんコントロールパネルを使うことが減っていく見込みです。

設定アプリは Windows 10 で導入された「ユニバーサル Windows
アプリ」の一種です。

ユニバーサル Windows
アプリはマウスでも画面タッチでも操作しやすいことを目指して作られており、
一般的に Alt キーで移動できるメニューバーがありません。

そのかわりに、折りたたんだり展開したりできる「メニューボタン」や「アプリバー」が、
「スタートウィンドウ」だけでなく、 「電卓」や「ボイスレコーダー」など
Windows 標準アプリにも取り入れられています。

Windows 10 の「設定」に慣れれば、 「ユニバーサル Windows
アプリ」の操作にもなじむことができると思います。

重要な設定項目について補足しておきます。

既定の Web ブラウザを変更するには、以下を使います。

-  設定「アプリ」「既定のアプリ」（Web ブラウザ）「Microsoft Edge
   ボタン」

このボタンを押すと「アプリを選ぶ ウィンドウ」が開きます。
リストではないので Tab で移動してください。 Internet Explorer, Firefox,
Chrome などを選択するとよいでしょう。

Windows Update に関しては以下を知っておくとよいでしょう。

-  設定「更新とセキュリティ」「Windows Update」「アクティブ時間の変更」

この設定で例えば午前5時から午後11時までをアクティブ時間にしておけば、
その時間には Windows Update が勝手に Windows を再起動しません。

Windows 10 Home ではアクティブ時間以外に Windows
が再起動することを止める設定はありません。

-  設定「更新とセキュリティ」「トラブルシューティング」「Windows
   Update」

この機能は Windows Update が失敗する原因を解決してくれます。
必ず解決できるわけではありませんが、定期的に実行するとよいでしょう。

6 NVDA の便利な機能
-------------------

6.1 アドオンの活用
~~~~~~~~~~~~~~~~~~

NVDA のためのさまざまな機能拡張ツール「アドオン」が入手可能です。

例えば視力のあるユーザーはフォーカスやレビューカーソルを視覚的に確認するために
「フォーカスハイライト」というアドオンを使うとよいでしょう。

アドオンの説明はユーザーガイドの下記をお読みください。

-  `ユーザーガイド 12.3
   アドオンマネージャー <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#AddonsManager>`__

NVDAメニュー
ツール「アドオンマネージャー」には、「アドオンを入手」というボタンがあり、
ここから「NVDAコミュニティによるアドオン紹介」というサイトを開くことができます。

NVDA を実行しているときにアドオンファイルを開く（実行する）と、
そのアドオンをインストールできます。

使い方の簡単なアドオンをふたつ紹介します。

現在のフォーカス位置の要素の操作を NVDA+H を押すと説明します：

-  `ControlUsageAssistant <http://addons.nvda-project.org/addons/controlUsageAssistant.ja.html>`__

フォーカス位置とレビューカーソル（オブジェクトナビゲーション）を強調表示します：

-  `FocusHighlight <http://addons.nvda-project.org/addons/focusHighlight.ja.html>`__

なお NVDA 2019.3jp
以降には「フォーカスハイライト」機能が備わっているので、アドオンは不要です。
NVDA
設定ダイアログ「ビジョン」カテゴリから「フォーカスハイライト」を有効にできます。

NVDA のアドオンはこのほかにも、さまざまなサイトで公開されていますが、
NVDA の最新版と互換性がないものやライセンスが不明なものも
ありますのでご注意ください。

NVDA の終了オプションで「アドオンを無効にして再起動」が選べます。
また「アドオンマネージャー」で、アドオンごとに無効の状態（保留中）に切り替えることもできます。

6.2 設定プロファイル
~~~~~~~~~~~~~~~~~~~~

NVDA の「設定プロファイル」は、
例えばアプリケーションごとにブラウズモードの設定を使い分けたいときに便利な機能です。

例として、メモ帳 (notepad) を使うときだけ音声エンジンの話者を変える
プロファイルを作ってみます。
この例を応用して、ぜひ便利な活用法を考えてください。

まず、NVDAとメモ帳を起動して、メモ帳のアプリケーションが選択された状態にします。
NVDA+Ctrl+Pを押して、設定プロファイルのダイアログを開きます。

さらにTabで「新規(N)」のボタンに移動して、スペースを押して
プロファイル作成のダイアログを開きます。

最初はプロファイルの名前の入力にフォーカスがありますが、 Tab
を押して「アクティブ化」の方法を選ぶラジオボタンに移動します。
右矢印を押すと「現在のアプリケーション(notepad)」が選択されます。

ここでShift+Tabを押してプロファイルの名前に戻ると、 名前に notepad
という名前が入ったことがわかります。

名前はさらに変更できますが、ここではEnterを押してダイアログを閉じます。

これからプロファイルを「通常の設定」に戻すまでは、 何か NVDA
の設定を変更すると、 この notepad というプロファイルでだけ有効になり、
notepad 以外には反映されません。

音声設定ダイアログで話者を（例えば mei から lite に）変更しましょう。

最後に、プロファイルを戻すために、もう一度 NVDA+Ctrl+P を押します。

プロファイルのリスト項目 「notepad（編集中、トリガーしました）」
が選択されているので、上下矢印（おそらく上矢印1回だと思いますが）で
「通常の設定」という設定に戻して、
「閉じる」ボタンで設定プロファイルのダイアログを閉じてください。

これで notepad は lite の声で、それ以外のアプリケーションは mei で
読み上げるようになります。

notepad というプロファイルを削除すればもとの状態に戻ります。

詳しくはユーザーガイドをお読みください。

-  `ユーザーガイド 11.4
   設定プロファイル <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#ConfigurationProfiles>`__

6.3 入力ジェスチャー
~~~~~~~~~~~~~~~~~~~~

NVDA
の操作のためのキー入力やタッチ操作、点字ディスプレイのスイッチ操作を、
NVDA ではまとめて「入力ジェスチャー」と呼びます。

NVDA の操作のための機能と「入力ジェスチャー」の対応は、 NVDA
メニューの設定「入力ジェスチャー」で自由に変更できます。
お使いのキーボードで押しにくい操作のキー入力を変更することもできます。

練習のためには例えば「日付と時刻の報告」を NVDA+Z に割り当てる、
といった設定をしてみてはどうでしょうか。

まず入力ヘルプやコマンド一覧表で、自分が割り当てたい機能がどういう名前で
どう分類されているかを把握しておくとよいでしょう。

実際の操作は「入力ジェスチャー」のツリービューで機能を探して、
その機能の下の階層にキー入力などの追加や削除を行う、
という手順になります。

ユーザーガイドの下記の項も参照してください。

-  `ユーザーガイド 11.2.3.
   入力ジェスチャー <https://www.nvda.jp/nvda2018.3.2jp/ja/userGuide.html#InputGestures>`__

6.4 タッチモード
~~~~~~~~~~~~~~~~

Windows 8 以降でタッチ対応ディスプレイがあれば NVDA
は自動的にタッチモードで動作します。 タッチモードは NVDA
をインストールした場合だけ有効で、ポータブル版の NVDA
では利用できません。

画面を触るとその場所にナビゲーターオブジェクトが移動します。
三本指タップで「テキストモード」「オブジェクトモード」が切り替わります。
オブジェクトモードでは左右にフリックするとナビゲーターオブジェクトが
「前の要素」「次の要素」に移動します。
ただし階層をまたいで自動的に移動してくれるので、キーボードよりもちょっと便利です。
テキストモードでは左右にフリックするとレビューカーソルが文字単位で左右に移動します。

「入力ジェスチャー」設定でタッチ操作の機能の割り当てを変えることもできます。

スクリーンリーダーでのキーボードなしでの文字入力は不可能ではないが難しいと思います。
キーボードなしで利用できるかどうかは、使いたいアプリや
作業の内容によりますので、事前にお調べになることをお勧めします。

なお、Windows 10
には「デスクトップモード」と「タブレットモード」があります。
タブレットモードではスタートメニューやアプリが全画面になった状態で（最大化されて）動作します。
このガイドブックでは「タブレットモード」については紹介しません。

7 最後に
--------

このガイドブックは NVDA
の機能を正確に説明することを目指して書かれました。
紹介できなかった話題については、
ユーザーガイドやインターネットの情報を合わせてご活用ください。
最後までお読みいただきありがとうございました。
