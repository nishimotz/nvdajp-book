NVDA で Gmail を使う
~~~~~~~~~~~~~~~~~~~~~~~~

Gmail の概要
^^^^^^^^^^^^^^^^^^

Gmail という電子メールのサービスを紹介します。

`Google <https://www.google.co.jp/>`__ が提供する Gmail
（ジーメール）は無料で使える高機能のメールサービスです。 Web
ブラウザで使用できる Gmail には「標準 HTML 形式」と「簡易 HTML
形式」の2種類のモードがありますが、 2015年ごろから標準 HTML 形式の Gmail
が Firefox と NVDA をサポートするようになりました。

Gmail には以下のような特長があります。

-  受信したメールを約15GBまで無料で保存可能
-  過去のメールの検索機能が充実
-  迷惑メール対策が充実
-  フォルダに振り分ける機能の代わりとして、アーカイブ、スター、ラベルなどでメッセージを整理できる
-  チャット、ハングアウト、カレンダーなど、他のサービスと連携
-  PC
   にインストールされたメールアプリや、スマートフォンのアプリからも利用できる

ここでは Firefox による Gmail の操作を説明します。
このセクションを執筆した時点での内容であることをお断りしておきます。

晴眼者が使う Web
サービスとまったく同じ画面をスクリーンリーダーで操作できるのは、最新の
Web アクセシビリティの技術の進歩と、 それを取り入れて改良してきた NVDA,
Firefox, Gmail の努力の結果です。

Gmail のような高機能の Web
サービスがスクリーンリーダーに対応しているということが、広く知られることを願っています。

Gmail を使う準備
^^^^^^^^^^^^^^^^^^^^^^

NVDA の設定は以下を想定しています。

-  設定 - キーボード設定

   -  「入力文字の読み上げ」チェック
   -  「入力単語の読み上げ」チェックなし
   -  「スペルの間違いを入力中に音で報告」チェック

-  設定 - ブラウズモード

   -  「サポートされている場合画面レイアウトを使用」チェックなし
   -  「ページ読み込み時に自動的に読み上げる」チェックなし
   -  「フォーカスの変化を追跡する自動フォーカスモード」チェックなし
   -  「フォーカスモードとブラウズモードの切替を音で報告」チェックなし

-  設定 - 書式情報

   -  「スペルの間違いの報告」チェック
   -  「クリック可能の報告」チェックなし

Firefox の設定は以下を想定しています。

-  詳細 - 一般

   -  アクセシビリティ

      -  「ページ中の移動にカーソルを使用する(キャレットブラウズモード)」チェックなし
      -  「キー入力時に検索を開始する」チェックなし

   -  ブラウズ

      -  「自動スペルチェック機能を使用する」チェック

Gmail アカウントの設定は以下を想定しています。 （「キーボード
ショートカット」の設定変更はのちほど説明します）

-  全般

   -  言語：Gmail 表示言語 日本語
   -  スレッド表示 ON チェック
   -  キーボード ショートカット ON チェック
   -  メール本文のプレビューを表示 チェック

-  受信トレイ

   -  カテゴリ

      -  ソーシャル チェックなし
      -  プロモーション チェックなし

-  チャット

   -  チャット OFF チェック

ナビゲーション、ショートカット、文字入力の切替
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

NVDA と Firefox の組み合わせで Gmail
を操作する状況では、以下のようないろいろな目的でキー入力が使われます。

-  Windows の操作（Windows キーなど）
-  Firefox のメニュー操作（Alt キーなど）
-  NVDA の操作（NVDA キーによる設定変更や Shift
   単独による読み上げ一時停止など）
-  1文字ナビゲーション（次のボタンにBで移動、次のコンボボックスにCで移動、など）
-  Gmail のキーボード ショートカット（新規メールの作成はC、など）
-  Gmail のエディットボックスへのテキスト入力

キー入力の目的を切り替えるために NVDA
には「ブラウズモード」と「フォーカスモード」があります。

-  NVDA+スペース：「ブラウズモード」「フォーカスモード」を切り替える
-  Enter：エディットボックスなどで「フォーカスモード」に切り替える
-  Esc：エディットボックスなどで「ブラウズモード」に切り替える

「ブラウズモード」（NVDA 2015.3 以降）には Gmail
の操作に役立つ特別な機能があります。

-  NVDA+Shift+スペース：ブラウズモードで「英字キーを入力に使用」「1文字ナビゲーションを使用」を切り替える

まとめると、以下のようなモードの使い分けができます：

-  フォーカスモード：Gmail
   のキーボードショートカットやテキスト入力が可能
-  ブラウズモード

   -  1文字ナビゲーションを使用：ブラウズモードのすべての操作が可能
   -  英字キーを入力に使用：矢印キーだけブラウズモードの操作、Gmail
      のキーボードショートカットやテキスト入力も可能

以下では「英字キーを入力に使用」はメールアドレスの入力に使います。
「フォーカスモード」は件名やメッセージ本文の入力に使います。
それ以外は「1文字ナビゲーションを使用」で操作します。 Gmail
のキーボードショートカットは有効にしますが、覚えるのが大変なので、いまは使わないことにします。

受信トレイと設定ページ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Firefox で「URLまたは検索語句を入力します エディット」に移動するには
Ctrl+L を押します。

これ以降の説明は `gmail.com <http://gmail.com>`__
を開いて、ログインに成功した状態を想定しています。

現在のページのタイトルを NVDA+T で確認します。
「受信トレイ」で始まる名前であることがわかります。

Firefox のメニューバーと Gmail のページ内容は Alt
キーを押すたびに行ったりきたりできます。

-  「ファイル サブメニュー Alt+F 1の7」
-  「受信トレイ - (あなたのアドレス) - Gmail ドキュメント テーブル
   ・・・」

確認できたら「受信トレイ」にフォーカスを戻します。
ドキュメント以外の場所にフォーカスがある場合は Tab で「Gmail
ドキュメント」に移動します。

次に NVDA+スペース で「ブラウズモード」にします。
「フォーカスモード」の場合は、もう一度 NVDA+スペース を押します。

1文字ナビゲーションのボタン(B)を使って、このページのボタンを把握します。
「次のボタンがありません」と言われたら NVDA+Tab
で現在位置を確認できます。 Shift+B で前のボタンに戻ります。

Gmail では「メニューボタン」も多く使われていますが、同じように B
でジャンプできます。

設定ページに移動して設定を変更してみましょう。

ボタン(B)で「設定 メニューボタン 折りたたみ サブメニュー」に移動します。
スペースを押してこの「設定」ボタンを実行します。

「展開 メニュー サブメニュー 表示間隔・・・」

画面表示では、メニューボタンを実行すると、元のページの上にメニューが開きます。

なお、メニューが開いているときに Esc
を押すと「メニューの外」と読み上げてメニューを閉じ、ボタンに戻ります。

メニューを開いたら下矢印キーを押して、以下の項目を確認します。

-  「表示間隔」
-  「チェックメニュー項目 チェック 標準 (より大きな画面の場合)」
-  「チェックメニュー項目 チェックなし 小 (より大きな画面の場合)」
-  「チェックメニュー項目 チェックなし 最小」
-  「区切り 使用不能」
-  「メニュー項目 受信トレイを設定」
-  「区切り 使用不能」
-  「メニュー項目 設定」
-  「メニュー項目 テーマ」
-  「メニュー項目 ヘルプ」

下矢印キーで「メニュー項目 設定」に戻って Enter を押します。

設定のページに移動したら、読み上げを途中で止めてかまいません。
念のために NVDA+T でウィンドウのタイトルを、NVDA+Tab
でフォーカスを確認します。

-  NVDA+T 「設定 - (あなたのアドレス) - Gmail - Mozilla Firefox」
-  NVDA+Tab 「全般 タブ フォーカス 選択 1の1」

ラジオボタン(R) を使って「キーボード ショートカット」を探します。

-  「キーボード ショートカット OFF ラジオボタン チェック」
-  「キーボード ショートカット ON ラジオボタン チェックなし」

こうなっている場合は ON のラジオボタンを選択します。

「キーボード ショートカット ON ラジオボタン
チェックなし」でスペースを押します。

「チェック」と読み上げれば設定を変更できています。

そして、ランドマーク(D)を使って移動します。

「ナビゲーション ランドマーク ボタン 変更を保存」

さらに下矢印キーを押すともうひとつボタンがあります。

「ボタン キャンセル」

上矢印キーで「変更を保存」に戻ります。

「変更を保存」でスペースを押すと
「使用不能」と読み上げられますが、すこし待つと「受信トレイ」に戻ります。
設定を変更しなかった場合は「キャンセル」を実行します。

なお、「変更を保存」と「キャンセル」のボタンは左右に並んでいるので
「画面レイアウト」だと上下矢印キーで「キャンセル」のボタンに移動できません。
その場合は NVDA+V で「画面レイアウトを使用しない」に切り替えます。

以上で Gmail
の「受信トレイ」と「設定」のページで使われているボタンやメニューを NVDA
で操作できました。

新規メッセージの作成
^^^^^^^^^^^^^^^^^^^^^^^^^^

「受信トレイ」のページからメールを作成して送信します。 手順は以下の (1)
から (5) のとおりです。

(1) 「作成」を実行

B または Shift+B を使って「作成 ボタン」でスペースを押します。

画面は「受信トレイ」のページの上に「新規メッセージ」というダイアログが重なった状態に変化します。

-  （前半の読み上げを省略）
-  「作成 新規メッセージ ダイアログ」
-  「To コンボボックス 折りたたみ 複数行 編集可能 オートコンプリート
   ブランク」

ダイアログの中では Tab と Shift+Tab でフォーカスの移動ができます。
（上下の矢印キーでも可能ですが Tab のほうが効率的です）
なお、このダイアログを閉じて「受信トレイ」に戻りたい場合は Esc
を押します。

(2) 「To」欄に送信先メールアドレスを入力

NVDA+Shift+スペース で「英字キーを入力に使用」にします。

もし「スペース」と読み上げたら NVDA+スペース
で「ブラウズモード」にして、やり直します。

半角全角キーを押して「変換停止」にします。

自分にメールを送ってみるために、自分のメールアドレスを入力します。

途中で「展開」という音声が聞こえても、無視してください。
訂正するときには Backspace と左右の矢印キーを使います。

入力し終わったら NVDA+Shift+スペース
で「1文字ナビゲーションを使用」にします。

Tab を押します。以下のように読み上げます。

「（メールアドレス）さんを追加しました。削除するには Backspace
キーを押してください」

さらに Tab と Shift+Tab を使って

-  「To - 連絡先の選択」
-  「（入力したメールアドレス）」
-  「コンボボックス 折りたたみ オートコンプリート 編集可能 複数行」

のように要素が並んでいることを確認します。

メールアドレスのところで Backspace を押すと削除ができます。
「編集可能」のところには、さらに送信先を追加できます。

ここでは説明しませんが、
連絡先に登録した相手や、過去に受け取ったメールの送信者をオートコンプリートで選ぶこともできます。

(3) 件名を入力

Tab キーを押して「件名 エディット」に移動します。

Enter で「フォーカスモード」にします。

半角全角キーで「変換停止」にします。

ここでちょっと寄り道をするのですが、 hello. (h e l l o ピリオド)
と入力するつもりで「h e l o
ピリオド」と間違えて入力したらどうなるか、試してみます。

最後のピリオドを入力したところで「ジー」というブザーの音が聞こえます。

これは「スペルの間違いを入力中に音で報告」の機能です。

Backspace を2回押して「l o ピリオド」と入力します。

今度はブザーの音が聞こえなくなります。

(4) 本文を入力

Tab キーで「メッセージ本文 エディット」に移動します。

半角全角キーで「文字変換」にします。

ローマ字で「こんにちは。」と入力して、ひらがなのまま Enter
で確定します。

-  k o n n n i t i h a ピリオド Enter

「こんにちは マル」という読み上げを確認します。

(5) 送信を実行

Tab キーを押して「送信 (Ctrl+Enter) ボタン」に移動します。

ここでスペースを押して送信を実行します。

「アラート メッセージを送信しました」と読み上げます。

なお、ボタンの説明にあったように、ダイアログの中では Ctrl+Enter
が送信のショートカットとして使えます。

受信トレイの確認
^^^^^^^^^^^^^^^^^^^^^^

「受信トレイ」ページで受信したメールを確認します。

NVDA+Shift+スペース を押して「1文字ナビゲーションを使用」にします。

テーブル(T) で以下の場所に移動します。

「メイン ランドマーク テーブル 1行8列のテーブル 1行1列」

下矢印キーで1列ずつ移動します。

-  「4列 自分」
-  「6列 リンク hello. こんにちは。」

のように、さきほど自分が送ったメールが表示されます。

メッセージを詳しく確認したい場合や、返信をしたい場合には、
このメールを選択して「スレッド」というページに移動します。

6列の場所で Enter を押します。 （スペースでも実行できます）

「スレッドを開きました。未読メッセージは1件です。テーブルの外 メイン
ランドマーク hello. 見出し レベル2」

「受信トレイ」からスレッドに切り替わりました。

ここでリスト項目(I)を使い、メッセージに移動します。

以下の内容が連続して読み上げられます：

-  「リスト 1項目 (送信者の名前とアドレス) 見出し レベル3 (送信時刻)」
-  「スター付き チェックボックス チェックなし」
-  「返信 ボタン」
-  「その他 メニューボタン 折りたたみ サブメニュー」
-  「To 自分」
-  「詳細を表示 ボタン」
-  「こんにちは。」
-  「クリックして 返信 リンク または 転送」

「こんにちは。」という行で左右の矢印キーを使えば、1文字ずつ文字を確認できます。

なお、「スター付き
チェックなし」は「スター」がついていないという意味です。
スターがついているときには「yellow-star チェックボックス
チェック」のようになります。

メール返信とアーカイブ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

スレッドのページで、読んでいるメールに対する返信のメッセージを書くことができます。

下矢印キーで「リンク 返信 または」に移動して Enter を押します。

-  「メッセージ本文 エディット」
-  「(メールアドレス)さんを追加しました。削除するには Backspace
   キーを押してください。」

返信のテキストを入力するエディットで Enter
を押して「フォーカスモード」にします。

今度は2行で書いてみます。

-  ありがとう。（Enter で改行）
-  よろしく。（Enter で改行）

フォーカスモードでは上下の矢印キーでエディットの1行目と2行目に移動できます。
左右の矢印キーでテキストカーソルを動かして1文字ずつ編集することもできます。

入力が終わったら Esc で「ブラウズモード」にします。

ボタン(B)で「送信(Ctrl+Enter) ボタン」に移動してスペースを押します。

「アラート メッセージを送信しました」

という音声が聞こえます。

NVDA+Shift+スペース で「1文字ナビゲーションを使用」にします。

ページはスレッドのままですが、リスト項目(I)
で確認すると、最初のメールと返信のメールの2件になっています。

このように Gmail
ではページが切り替わらないのにページの一部分が更新されることが頻繁にあります。

2番目の項目の中身を上下の矢印キーで確認します。

「ありがとう。よろしく。」というメッセージの下に「引用」として「こんにちは。」が書かれていることがわかります。

さて、不要になったメールは「アーカイブ」すると「受信トレイ」に表示されなくなります。
こうしておくと、新しいメールをいつでも探しやすくなります。

ボタン(B)で「アーカイブ ボタン」に移動してスペースを押します。

アーカイブが完了すると「受信トレイ」ページに戻っていることが確認できます。

テーブル(T)で確認すると「新着メールはありません」に変わっています。

メールの検索
^^^^^^^^^^^^^^^^^^

アーカイブされたメールは削除されるわけではなく「すべてのメール」という場所に保存されます。
「受信トレイ」ページから「検索」を使ってみます。

エディット(E)で「検索 エディット サブメニュー」に移動します。

Enter を押して「フォーカスモード」にします。

半角全角キーで「変換停止」を確認します。

hello (h e l l o) と入力します。

Esc を押して「ブラウズモード」にします。

ボタン(B) を2回押して「Gmail を検索
ボタン」に移動してスペースを押します。

実行すると「検索結果」というページの「テーブル」に移動しています。 Gmail
では複数のメールによるやりとりを「スレッド」という単位で管理しており、
受信トレイや検索結果のテーブルでは1行が1つのスレッドに対応します。

受信トレイと同じように項目に移動して Enter
でスレッドのページに移動できます。

検索結果のページからは以下の操作で受信トレイに戻ります。

-  Shift+D で「ラベル ナビゲーション ランドマーク」に移動
-  上下の矢印キーで「既読 リンク 受信トレイ」に移動
-  Enter で実行

以上で Gmail の基本的な操作を紹介しました。
マスターできたら、自分以外のメールアドレスに送信してみましょう。

なお「スペルの間違いを入力中に音で報告」は NVDA 2016.2
で追加された機能です。
現在は日本語には対応していませんが、便利さを理解していただけたと思います。

(資料) 1文字ナビゲーションのまとめ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

`ユーザーガイド 6.1.
1文字ナビゲーション <https://www.nvda.jp/nvda2021.3.5jp/ja/userGuide.html#SingleLetterNavigation>`__
から、Gmail で便利な操作を引用します。

-  K リンク
-  N リンクのないテキスト
-  H 見出し
-  D ランドマーク
-  E エディットフィールド
-  B ボタン
-  T テーブル
-  I リスト項目

(資料) Gmail サポート情報
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Gmail アカウントの作成：

Gmail を使うには Google アカウントが必要です。
お持ちでない場合はまずアカウントを作成してください。
メールを受け取ることができる既存のアドレスや生年月日などの個人情報が必要です。
必須ではありませんがスマートフォンの電話番号などの入力も求められます。

携帯メールのアドレスまたは音声通話を受けられる電話番号を入力して、6桁の確認番号を受け取って、それを画面に入力する、といった本人確認（端末確認）が必要になる場合もあります。

-  `Gmail
   アドレスの作成 <https://support.google.com/mail/answer/56256?hl=ja>`__

その他の Gmail サポートのリンク：

-  `標準 HTML 形式と簡易 HTML
   形式 <https://support.google.com/mail/answer/15049?hl=ja>`__
-  `スクリーン リーダーでの Gmail
   標準形式の使用 <https://support.google.com/mail/answer/90559?hl=ja>`__
-  `Gmail のキーボード
   ショートカット <https://support.google.com/mail/answer/6594?hl=ja>`__

(資料) Gmail ページの構造
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Gmail のページに含まれる要素を独自に調査した情報です。 この内容は Gmail
のアカウントごとの設定によって異なる場合があります。 また、将来 Gmail
の仕様が変更される場合があります。

B や K
などのアルファベットは、1文字ナビゲーションの対象であることを示します。
例えば H2 は 見出しレベル2 なので、1文字ナビゲーションの H または 2
で移動できます。

「受信トレイ」ページに含まれる要素：

-  B 簡易HTML形式（表示なし）

-  K コンテンツへ（表示なし）

-  K Gmailでのスクリーンリーダーの使用（表示なし）

-  D バナー

   -  Googleバー

      -  K Googleアプリ 折りたたみ
      -  K Googleのお知らせ 折りたたみ
      -  K Googleアカウント（メールアドレス）折りたたみ

   -  Gmailアクションバー

      -  K Gmail（ロゴ画像）
      -  D 検索 H2
      -  E 検索 サブメニュー
      -  B 詳細検索オプション
      -  B Gmailを検索

-  アラート（一時的に表示される）

   -  xxがxxされました
   -  K 詳細
   -  K 取消

-  B 移動先 メニューボタン サブメニュー

-  B 作成

-  D ラベル ナビゲーション H2

   -  K 受信トレイ
   -  K スターつき
   -  K 送信済みメール
   -  K 下書き
   -  B 開く

-  B メニューボタン サブメニュー 選択（すべてのスレッドを選択）

-  B 更新（スレッド未選択の場合に表示）

-  B アーカイブ（スレッドを選択すると表示）

-  B 迷惑メールを報告（スレッドを選択すると表示）

-  B 削除（スレッドを選択すると表示）

-  B 移動（スレッドを選択すると表示）

-  B ラベル（スレッドを選択すると表示）

-  B その他

-  B xx-xx / xx
   ボタン（表示されているメッセージの数／すべてのメッセージの数）

-  B 前

-  B 次

-  B 設定

-  D メイン スレッド H2

   -  T xx行8列のテーブル（Ctrl+Alt+矢印キーで移動）

      -  1列 ブランク
      -  2列 チェックボックス
      -  3列 画像
         スターなし（スターの場合も「スターなし」と読みあげる？）
      -  4列 送信者
      -  5列 ブランク
      -  6列 題名と本文
      -  7列 ブランク
      -  8列 日付と時刻

-  フッター

   -  xxGB (xx%) / xxGB を使用中
   -  K 管理
   -  K 利用規約
   -  K プライバシー
   -  前回のアカウント アクティビティ xx 分前
   -  K アカウント アクティビティの詳細

スレッドのページに含まれる要素：

-  K コンテンツへ（表示なし）

-  K Gmailでのスクリーンリーダーの使用 展開（表示なし）

-  K キーボードショートカット（表示なし）

-  K Gmail（標準HTML形式）ガイド（表示なし）

-  D バナー

   -  Googleバー

      -  K Googleアプリ 折りたたみ
      -  K Googleのお知らせ 折りたたみ
      -  K Googleアカウント（アカウント名）折りたたみ

   -  Gmailアクションバー

      -  K Gmail（ロゴ画像）
      -  D 検索 H2
      -  E 検索 サブメニュー
      -  B 詳細検索オプション
      -  B Gmailを検索
      -  B ナビゲート

-  アラート（一時的に表示される）

   -  xxがxxされました
   -  K 詳細
   -  K 取消

-  B 移動先 折りたたみ

-  B 作成

-  D ラベル ナビゲーション H2

   -  K 受信トレイ
   -  K スターつき
   -  K 送信済みメール
   -  K 下書き
   -  B 開く

-  D 補足情報 ハングアウト H2

   -  B チャット設定
   -  B チャット相手を検索

-  B 受信トレイに戻る（または現在のラベルの名前）

-  B アーカイブ

-  B 迷惑メールを報告

-  B 削除

-  B 移動 折りたたみ（ラベルによって異なる）

-  B ラベル 折りたたみ

-  B その他 折りたたみ

-  B 前

-  B 次

-  B 設定 折りたたみ

-  D メイン

   -  B すべて展開
   -  B すべて印刷
   -  B 新しいウィンドウで開く
   -  H2 （スレッドの題名）
   -  B ラベル名（同じラベルがついたメッセージを検索）
   -  B エックス（スレッドからこのラベルを削除）
   -  I （送信者の名前とアドレス リスト項目） H3

      -  B 返信
      -  B その他 メニューボタン 折りたたみ サブメニュー
      -  B 詳細を表示
      -  N メッセージの内容

         -  K メッセージに含まれるリンク

      -  K 添付ファイル エリア

         -  B 添付ファイル xx をダウンロード
         -  B ドライブへ添付ファイル xx を保存

      -  B 短縮されたコンテンツを表示する

   -  I （送信者の名前とアドレス リスト項目） H3
   -  K 返信
   -  K 転送

-  フッター

   -  xxGB (xx%) / xxGB を使用中
   -  K 管理
   -  K 利用規約
   -  K プライバシー
   -  K アカウント アクティビティの詳細

-  D 補足情報 xxさんのプロフィール写真

   -  B Google+に参加
   -  B xxさんとハングアウト
   -  B xxさんとのビデオ ハングアウトを開始
   -  B xxさんにメールを送信
   -  B その他の操作 折りたたみ
   -  K 詳細を表示

